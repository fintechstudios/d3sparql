{"version":3,"file":"d3sparql.umd.js","sources":["../d3sparql.js"],"sourcesContent":["//\n// d3sparql.js - utilities for visualizing SPARQL results with the D3 library\n//\n//   Web site: http://github.com/ktym/d3sparql/\n//   Copyright: 2013-2015 (C) Toshiaki Katayama (ktym@dbcls.jp)\n//   License: BSD license (same as D3.js)\n//   Initial version: 2013-01-28\n//\n\nimport d3 from 'd3';\n\nconst d3sparql = {\n  version: 'd3sparql.js version 2020-04-25',\n  debug: false  // set to true for showing debug information\n};\n\nfunction debug(messageGetter) {\n  if (d3sparql.debug) {\n    switch (typeof messageGetter) {\n      case 'function':\n        console.debug(messageGetter());\n        break;\n      case 'object':\n        console.debug(JSON.stringify(messageGetter));\n        break;\n      default:\n        console.debug(messageGetter);\n    }\n  }\n}\n\n/*\n  Execute a SPARQL query and pass the result to a given callback function\n\n  Synopsis:\n    <!DOCTYPE html>\n    <meta charset=\"utf-8\">\n    <html>\n     <head>\n      <script src=\"http://d3js.org/d3.v3.min.js\"></script>\n      <script src=\"d3sparql.js\"></script>\n      <script>\n       function exec() {\n         let endpoint = d3.select(\"#endpoint\").property(\"value\")\n         let sparql = d3.select(\"#sparql\").property(\"value\")\n         d3sparql.query(endpoint, sparql, render)\n       }\n       function render(json) {\n         // set options and call the d3sparql.xxxxx visualization methods in this library ...\n         let config = {\n          \"margin\": {\"top\": 10, \"right\": 10, \"bottom\": 10, \"left\": 10},\n          \"selector\": \"#result\",\n          ...\n         }\n         d3sparql.xxxxx(json, config)\n       }\n      </script>\n      <style>\n      <!-- customize CSS -->\n      </style>\n     </head>\n     <body onload=\"exec()\">\n      <form style=\"display:none\">\n       <input id=\"endpoint\" value=\"http://dbpedia.org/sparql\" type=\"text\">\n       <textarea id=\"sparql\">\n        PREFIX ...\n        SELECT ...\n        WHERE { ... }\n       </textarea>\n      </form>\n      <div id=\"result\"></div>\n     </body>\n    </html>\n*/\nd3sparql.fetch = function (url, callback) {\n  debug(url);\n  let mime = 'application/sparql-results+json';\n  d3.xhr(url, mime, function (request) {\n    let json = request.responseText;\n    debug(json);\n    callback(JSON.parse(json));\n  });\n  /*\n    // d3.json sometimes fails to retrieve \"application/sparql-results+json\" as it is designed for \"application/json\"\n    d3.json(url, function(error, json) {\n      if (d3sparql.debug) { console.log(error) }\n      if (d3sparql.debug) { console.log(json) }\n      callback(json)\n    })\n  */\n};\n\nd3sparql.query = function (endpoint, sparql, callback) {\n  let url = endpoint + '?query=' + encodeURIComponent(sparql);\n  debug(endpoint);\n  d3sparql.fetch(url, callback);\n};\n\n\n/*\n  Convert sparql-results+json object into a JSON graph in the {\"nodes\": [], \"links\": []} form.\n  Suitable for d3.layout.force(), d3.layout.sankey() etc.\n\n  Options:\n    config = {\n      \"key1\":   \"node1\",       // SPARQL letiable name for node1 (optional; default is the 1st letiable)\n      \"key2\":   \"node2\",       // SPARQL letiable name for node2 (optional; default is the 2nd letibale)\n      \"label1\": \"node1label\",  // SPARQL letiable name for the label of node1 (optional; default is the 3rd letiable)\n      \"label2\": \"node2label\",  // SPARQL letiable name for the label of node2 (optional; default is the 4th letiable)\n      \"value1\": \"node1value\",  // SPARQL letiable name for the value of node1 (optional; default is the 5th letiable)\n      \"value2\": \"node2value\"   // SPARQL letiable name for the value of node2 (optional; default is the 6th letiable)\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.forcegraph(json, config)\n      d3sparql.sankey(json, config)\n    }\n\n  TODO:\n    Should follow the convention in the miserables.json https://gist.github.com/mbostock/4062045 to contain group for nodes and value for edges.\n*/\nd3sparql.graph = function (json, config = {}) {\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'key1': config.key1 || head[0] || 'key1',\n    'key2': config.key2 || head[1] || 'key2',\n    'label1': config.label1 || head[2] || false,\n    'label2': config.label2 || head[3] || false,\n    'value1': config.value1 || head[4] || false,\n    'value2': config.value2 || head[5] || false,\n  };\n  let graph = {\n    'nodes': [],\n    'links': []\n  };\n  let check = d3.map();\n  let index = 0;\n  for (let i = 0; i < data.length; i++) {\n    let key1 = data[i][opts.key1].value;\n    let key2 = data[i][opts.key2].value;\n    let label1 = opts.label1 ? data[i][opts.label1].value : key1;\n    let label2 = opts.label2 ? data[i][opts.label2].value : key2;\n    let value1 = opts.value1 ? data[i][opts.value1].value : false;\n    let value2 = opts.value2 ? data[i][opts.value2].value : false;\n    if (!check.has(key1)) {\n      graph.nodes.push({ 'key': key1, 'label': label1, 'value': value1 });\n      check.set(key1, index);\n      index++;\n    }\n    if (!check.has(key2)) {\n      graph.nodes.push({ 'key': key2, 'label': label2, 'value': value2 });\n      check.set(key2, index);\n      index++;\n    }\n    graph.links.push({ 'source': check.get(key1), 'target': check.get(key2) });\n  }\n  debug(() => JSON.stringify(graph));\n  return graph;\n};\n\n/*\n  Convert sparql-results+json object into a JSON tree of {\"name\": name, \"value\": size, \"children\": []} format like in the flare.json file.\n\n  Suitable for d3.layout.hierarchy() family\n    * cluster:    d3sparql.dendrogram()\n    * pack:       d3sparql.circlepack()\n    * partition:  d3sparql.sunburst()\n    * tree:       d3sparql.roundtree()\n    * treemap:    d3sparql.treemap(), d3sparql.treemapzoom()\n\n  Options:\n    config = {\n      \"root\":   \"root_name\",    // SPARQL letiable name for root node (optional; default is the 1st letiable)\n      \"parent\": \"parent_name\",  // SPARQL letiable name for parent node (optional; default is the 2nd letiable)\n      \"child\":  \"child_name\",   // SPARQL letiable name for child node (ptional; default is the 3rd letiable)\n      \"value\":  \"value_name\"    // SPARQL letiable name for numerical value of the child node (optional; default is the 4th letiable or \"value\")\n    }\n\n  Synopsis:\n    d3sparql.sparql(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.roundtree(json, config)\n      d3sparql.dendrogram(json, config)\n      d3sparql.sunburst(json, config)\n      d3sparql.treemap(json, config)\n      d3sparql.treemapzoom(json, config)\n    }\n*/\nd3sparql.tree = function (json, config = {}) {\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'root': config.root || head[0],\n    'parent': config.parent || head[1],\n    'child': config.child || head[2],\n    'value': config.value || head[3] || 'value',\n  };\n\n  let pair = d3.map();\n  let size = d3.map();\n  let root = data[0][opts.root].value;\n  let parent = true;\n  let child = parent;\n  for (let i = 0; i < data.length; i++) {\n    const datum = data[i];\n    parent = datum[opts.parent].value;\n    child = datum[opts.child].value;\n    if (parent !== child) {\n      /** @type {Array} */\n      let children;\n      if (pair.has(parent)) {\n        children = pair.get(parent);\n        children.push(child);\n      } else {\n        children = [child];\n      }\n      pair.set(parent, children);\n      if (datum[opts.value]) {\n        size.set(child, datum[opts.value].value);\n      }\n    }\n  }\n\n  function traverse(node) {\n    let list = pair.get(node);\n    if (list) {\n      let children = list.map(function (d) {\n        return traverse(d);\n      });\n      // sum of values of children\n      let subtotal = d3.sum(children, function (d) {\n        return d.value;\n      });\n      // add a value of parent if exists\n      let total = d3.sum([subtotal, size.get(node)]);\n      return { 'name': node, 'children': children, 'value': total };\n    } else {\n      return { 'name': node, 'value': size.get(node) || 1 };\n    }\n  }\n\n  let tree = traverse(root);\n\n  debug(() => JSON.stringify(tree));\n  return tree;\n};\n\n/*\n  Rendering sparql-results+json object containing multiple rows into a HTML table\n\n  Options:\n    config = {\n      \"selector\": \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.htmltable(json, config)\n    }\n\n  CSS:\n    <style>\n    table {\n      margin: 10px;\n    }\n    th {\n      background: #eeeeee;\n    }\n    th:first-letter {\n       text-transform: capitalize;\n    }\n    </style>\n*/\nd3sparql.htmltable = function (json, config = {}) {\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    columns: config.columns || head,\n    selector: config.selector || null,\n    limit: config.limit || data.length,\n    offset: config.offset !== undefined ? config.offset : 0,\n  };\n\n  data = data.slice(opts.offset, opts.offset + opts.limit);\n\n  let table = d3sparql.select(opts.selector, 'htmltable').append('table').attr('class', 'table table-bordered');\n  debug(\"Table\");\n  debug(table);\n  let thead = table.append('thead');\n  let tbody = table.append('tbody');\n  thead.append('tr')\n    .selectAll('th')\n    .data(opts.columns)\n    .enter()\n    .append('th')\n    .text((col) => col);\n  let rows = tbody.selectAll('tr')\n    .data(data)\n    .enter()\n    .append('tr');\n  let cells = rows.selectAll('td')\n    .data((row) => opts.columns.map((col) => row[col] ? row[col].value : ''))\n    .enter()\n    .append('td')\n    .text((val) => val);\n\n  debug(\"Table cells\");\n  debug(cells);\n\n  // default CSS\n  table.style({\n    'margin': '10px'\n  });\n  table.selectAll('th').style({\n    'background': '#eeeeee',\n    'text-transform': 'capitalize',\n  });\n};\n\n/*\n  Rendering sparql-results+json object containing one row into a HTML table\n\n  Options:\n    config = {\n      \"selector\": \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.htmlhash(json, config)\n    }\n\n  CSS:\n    <style>\n    table {\n      margin: 10px;\n    }\n    th {\n      background: #eeeeee;\n    }\n    th:first-letter {\n       text-transform: capitalize;\n    }\n    </style>\n*/\nd3sparql.htmlhash = function (json, config) {\n  config = config || {};\n\n  let head = json.head.lets || [];\n  let data = json.results.bindings[0];\n\n  let opts = {\n    'selector': config.selector || null\n  };\n\n  let table = d3sparql.select(opts.selector, 'htmlhash').append('table').attr('class', 'table table-bordered');\n  let tbody = table.append('tbody');\n  let row = tbody.selectAll('tr')\n    .data(function () {\n      return head.map(function (col) {\n        return { 'head': col, 'data': data[col] ? data[col].value : '' };\n      });\n    })\n    .enter()\n    .append('tr');\n  row.append('th')\n    .text(function (d) {\n      return d.head;\n    });\n  row.append('td')\n    .text(function (d) {\n      return d.data;\n    });\n\n  // default CSS\n  table.style({\n    'margin': '10px'\n  });\n  table.selectAll('th').style({\n    'background': '#eeeeee',\n    'text-transform': 'capitalize',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a bar chart\n\n  References:\n    http://bl.ocks.org/mbostock/3885304\n    http://bl.ocks.org/mbostock/4403522\n\n  Options:\n    config = {\n      \"label_x\":  \"Prefecture\",  // label for x-axis (optional; default is same as let_x)\n      \"label_y\":  \"Area\",        // label for y-axis (optional; default is same as let_y)\n      \"let_x\":    \"pref\",        // SPARQL letiable name for x-axis (optional; default is the 1st letiable)\n      \"let_y\":    \"area\",        // SPARQL letiable name for y-axis (optional; default is the 2nd letiable)\n      \"width\":    850,           // canvas width (optional)\n      \"height\":   300,           // canvas height (optional)\n      \"margin\":   40,            // canvas margin (optional)\n      \"selector\": \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.barchart(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .bar {\n      fill: steelblue;\n    }\n    .bar:hover {\n      fill: brown;\n    }\n    .axis {\n      font: 10px sans-serif;\n    }\n    .axis path,\n    .axis line {\n      fill: none;\n      stroke: #000000;\n      shape-rendering: crispEdges;\n    }\n    .x.axis path {\n      display: none;\n    }\n    </style>\n*/\nd3sparql.barchart = function (json, config) {\n  config = config || {};\n\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'label_x': config.label_x || head[0],\n    'label_y': config.label_y || head[1],\n    'let_x': config.let_x || head[0],\n    'let_y': config.let_y || head[1],\n    'width': config.width || 750,\n    'height': config.height || 300,\n    'margin': config.margin || 80,  // TODO: to make use of {top: 10, right: 10, bottom: 80, left: 80}\n    'selector': config.selector || null\n  };\n\n  let scale_x = d3.scale.ordinal().rangeRoundBands([0, opts.width - opts.margin], 0.1);\n  let scale_y = d3.scale.linear().range([opts.height - opts.margin, 0]);\n  let axis_x = d3.svg.axis().scale(scale_x).orient('bottom');\n  let axis_y = d3.svg.axis().scale(scale_y).orient('left');  // .ticks(10, \"%\")\n  scale_x.domain(data.map(function (d) {\n    return d[opts.let_x].value;\n  }));\n  scale_y.domain(d3.extent(data, function (d) {\n    return parseInt(d[opts.let_y].value);\n  }));\n\n  let svg = d3sparql.select(opts.selector, 'barchart').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height);\n//    .append(\"g\")\n//    .attr(\"transform\", \"translate(\" + opts.margin + \",\" + 0 + \")\")\n\n  let ax = svg.append('g')\n    .attr('class', 'axis x')\n    .attr('transform', 'translate(' + opts.margin + ',' + (opts.height - opts.margin) + ')')\n    .call(axis_x);\n  let ay = svg.append('g')\n    .attr('class', 'axis y')\n    .attr('transform', 'translate(' + opts.margin + ',0)')\n    .call(axis_y);\n  let bar = svg.selectAll('.bar')\n    .data(data)\n    .enter()\n    .append('rect')\n    .attr('transform', 'translate(' + opts.margin + ',' + 0 + ')')\n    .attr('class', 'bar')\n    .attr('x', function (d) {\n      return scale_x(d[opts.let_x].value);\n    })\n    .attr('width', scale_x.rangeBand())\n    .attr('y', function (d) {\n      return scale_y(d[opts.let_y].value);\n    })\n    .attr('height', function (d) {\n      return opts.height - scale_y(parseInt(d[opts.let_y].value)) - opts.margin;\n    });\n  /*\n      .call(function(e) {\n        e.each(function(d) {\n          console.log(parseInt(d[opts.let_y].value))\n        })\n      })\n  */\n  ax.selectAll('text')\n    .attr('dy', '.35em')\n    .attr('x', 10)\n    .attr('y', 0)\n    .attr('transform', 'rotate(90)')\n    .style('text-anchor', 'start');\n  ax.append('text')\n    .attr('class', 'label')\n    .text(opts.label_x)\n    .style('text-anchor', 'middle')\n    .attr('transform', 'translate(' + ((opts.width - opts.margin) / 2) + ',' + (opts.margin - 5) + ')');\n  ay.append('text')\n    .attr('class', 'label')\n    .text(opts.label_y)\n    .style('text-anchor', 'middle')\n    .attr('transform', 'rotate(-90)')\n    .attr('x', 0 - (opts.height / 2))\n    .attr('y', 0 - (opts.margin - 20));\n\n  // default CSS/SVG\n  bar.attr({\n    'fill': 'steelblue',\n  });\n  svg.selectAll('.axis').attr({\n    'stroke': 'black',\n    'fill': 'none',\n    'shape-rendering': 'crispEdges',\n  });\n  svg.selectAll('text').attr({\n    'stroke': 'none',\n    'fill': 'black',\n    'font-size': '8pt',\n    'font-family': 'sans-serif',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a pie chart\n\n  References:\n    http://bl.ocks.org/mbostock/3887235 Pie chart\n    http://bl.ocks.org/mbostock/3887193 Donut chart\n\n  Options:\n    config = {\n      \"label\":    \"pref\",    // SPARQL letiable name for slice label (optional; default is the 1st letiable)\n      \"size\":     \"area\",    // SPARQL letiable name for slice value (optional; default is the 2nd letiable)\n      \"width\":    700,       // canvas width (optional)\n      \"height\":   600,       // canvas height (optional)\n      \"margin\":   10,        // canvas margin (optional)\n      \"hole\":     50,        // radius size of a center hole (optional; 0 for pie, r > 0 for doughnut)\n      \"selector\": \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.piechart(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .label {\n      font: 10px sans-serif;\n    }\n    .arc path {\n      stroke: #ffffff;\n    }\n    </style>\n*/\nd3sparql.piechart = function (json, config = {}) {\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'label': config.label || head[0],\n    'size': config.size || head[1],\n    'width': config.width || 700,\n    'height': config.height || 700,\n    'margin': config.margin || 10,\n    'hole': config.hole || 100,\n    'selector': config.selector || null\n  };\n\n  let radius = Math.min(opts.width, opts.height) / 2 - opts.margin;\n  let hole = Math.max(Math.min(radius - 50, opts.hole), 0);\n  let color = d3.scale.category20();\n\n  let arc = d3.svg.arc()\n    .outerRadius(radius)\n    .innerRadius(hole);\n\n  let pie = d3.layout.pie()\n    //.sort(null)\n    .value(function (d) {\n      return d[opts.size].value;\n    });\n\n  let svg = d3sparql\n    .select(opts.selector, 'piechart')\n    .append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height)\n    .append('g')\n    .attr('transform', 'translate(' + opts.width / 2 + ',' + opts.height / 2 + ')');\n\n  let g = svg.selectAll('.arc')\n    .data(pie(data))\n    .enter()\n    .append('g')\n    .attr('class', 'arc');\n  let slice = g.append('path')\n    .attr('d', arc)\n    .attr('fill', function (d, i) {\n      return color(i);\n    });\n  let text = g.append('text')\n    .attr('class', 'label')\n    .attr('transform', function (d) {\n      return 'translate(' + arc.centroid(d) + ')';\n    })\n    .attr('dy', '.35em')\n    .attr('text-anchor', 'middle')\n    .text(function (d) {\n      return d.data[opts.label].value;\n    });\n\n  // default CSS/SVG\n  slice.attr({\n    'stroke': '#ffffff',\n  });\n  // TODO: not working?\n  svg.selectAll('text').attr({\n    'stroke': 'none',\n    'fill': 'black',\n    'font-size': '20px',\n    'font-family': 'sans-serif',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a scatter plot\n\n  References:\n    http://bl.ocks.org/mbostock/3244058\n\n  Options:\n    config = {\n      \"label_x\":  \"Size\",    // label for x-axis (optional; default is same as let_x)\n      \"label_y\":  \"Count\",   // label for y-axis (optional; default is same as let_y)\n      \"let_x\":    \"size\",    // SPARQL letiable name for x-axis values (optional; default is the 1st letiable)\n      \"let_y\":    \"count\",   // SPARQL letiable name for y-axis values (optional; default is the 2nd letiable)\n      \"let_r\":    \"volume\",  // SPARQL letiable name for radius (optional; default is the 3rd letiable)\n      \"min_r\":    1,         // minimum radius size (optional; default is 1)\n      \"max_r\":    20,        // maximum radius size (optional; default is 20)\n      \"width\":    850,       // canvas width (optional)\n      \"height\":   300,       // canvas height (optional)\n      \"margin_x\": 80,        // canvas margin x (optional)\n      \"margin_y\": 40,        // canvas margin y (optional)\n      \"selector\": \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.scatterplot(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .label {\n      font-size: 10pt;\n    }\n    .node circle {\n      stroke: black;\n      stroke-width: 1px;\n      fill: pink;\n      opacity: 0.5;\n    }\n    </style>\n*/\nd3sparql.scatterplot = function (json, config = {}) {\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'label_x': config.label_x || head[0] || 'x',\n    'label_y': config.label_y || head[1] || 'y',\n    'label_r': config.label_r || head[2] || 'r',\n    'let_x': config.let_x || head[0],\n    'let_y': config.let_y || head[1],\n    'let_r': config.let_r || head[2] || 5,\n    'min_r': config.min_r || 1,\n    'max_r': config.max_r || 20,\n    'width': config.width || 850,\n    'height': config.height || 300,\n    'margin_x': config.margin_x || 80,\n    'margin_y': config.margin_y || 40,\n    'selector': config.selector || null\n  };\n  let extent_x = d3.extent(data, function (d) {\n    return parseInt(d[opts.let_x].value);\n  });\n  let extent_y = d3.extent(data, function (d) {\n    return parseInt(d[opts.let_y].value);\n  });\n  let extent_r = d3.extent(data, function (d) {\n    return parseInt(d[opts.let_r] ? d[opts.let_r].value : opts.let_r);\n  });\n  let scale_x = d3.scale.linear().range([opts.margin_x, opts.width - opts.margin_x]).domain(extent_x);\n  let scale_y = d3.scale.linear().range([opts.height - opts.margin_y, opts.margin_y]).domain(extent_y);\n  let scale_r = d3.scale.linear().range([opts.min_r, opts.max_r]).domain(extent_r);\n  let axis_x = d3.svg.axis().scale(scale_x);\n  let axis_y = d3.svg.axis().scale(scale_y).orient('left');\n\n  let svg = d3sparql.select(opts.selector, 'scatterplot').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height);\n  let circle = svg.selectAll('circle')\n    .data(data)\n    .enter()\n    .append('circle')\n    .attr('class', 'node')\n    .attr('cx', function (d) {\n      return scale_x(d[opts.let_x].value);\n    })\n    .attr('cy', function (d) {\n      return scale_y(d[opts.let_y].value);\n    })\n    .attr('r', function (d) {\n      return scale_r(d[opts.let_r] ? d[opts.let_r].value : opts.let_r);\n    })\n    .attr('opacity', 0.5)\n    .append('title')\n    .text(function (d) {\n      return d[opts.label_r] ? d[opts.label_r].value : opts.label_r;\n    });\n  let ax = svg.append('g')\n    .attr('class', 'x axis')\n    .attr('transform', 'translate(0,' + (opts.height - opts.margin_y) + ')')\n    .call(axis_x);\n  let ay = svg.append('g')\n    .attr('class', 'y axis')\n    .attr('transform', 'translate(' + opts.margin_x + ',0)')\n    .call(axis_y);\n  ax.append('text')\n    .attr('class', 'label')\n    .text(opts.label_x)\n    .style('text-anchor', 'middle')\n    .attr('transform', 'translate(' + ((opts.width - opts.margin_x) / 2) + ',' + (opts.margin_y - 5) + ')');\n  ay.append('text')\n    .attr('class', 'label')\n    .text(opts.label_y)\n    .style('text-anchor', 'middle')\n    .attr('transform', 'rotate(-90)')\n    .attr('x', 0 - (opts.height / 2))\n    .attr('y', 0 - (opts.margin_x - 20));\n\n  // default CSS/SVG\n  ax.attr({\n    'stroke': 'black',\n    'fill': 'none',\n  });\n  ay.attr({\n    'stroke': 'black',\n    'fill': 'none',\n  });\n  // This doesn't work with .append(\"circle\") with .append(\"title\") for tooltip\n  circle.attr({\n    'stroke': 'gray',\n    'stroke-width': '1px',\n    'fill': 'lightblue',\n    'opacity': 0.5,\n  });\n  //svg.selectAll(\".label\").attr({\n  svg.selectAll('text').attr({\n    'stroke': 'none',\n    'fill': 'black',\n    'font-size': '8pt',\n    'font-family': 'sans-serif',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a force graph\n\n  References:\n    http://bl.ocks.org/mbostock/4062045\n\n  Options:\n    config = {\n      \"radius\":   12,        // static value or a function to calculate radius of nodes (optional)\n      \"charge\":   -250,      // force between nodes (optional; negative: repulsion, positive: attraction)\n      \"distance\": 30,        // target distance between linked nodes (optional)\n      \"width\":    1000,      // canvas width (optional)\n      \"height\":   500,       // canvas height (optional)\n      \"label\":    \"name\",    // SPARQL letiable name for node labels (optional)\n      \"selector\": \"#result\"\n      // options for d3sparql.graph() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.forcegraph(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .link {\n      stroke: #999999;\n    }\n    .node {\n      stroke: black;\n      opacity: 0.5;\n    }\n    circle.node {\n      stroke-width: 1px;\n      fill: lightblue;\n    }\n    text.node {\n      font-family: \"sans-serif\";\n      font-size: 8px;\n    }\n    </style>\n\n  TODO:\n    Try other d3.layout.force options.\n*/\nd3sparql.forcegraph = function (json, config = {}) {\n  let graph = (json.head && json.results) ? d3sparql.graph(json, config) : json;\n\n  let scale = d3.scale.linear()\n    .domain(d3.extent(graph.nodes, function (d) {\n      return parseFloat(d.value);\n    }))\n    .range([1, 20]);\n\n  let opts = {\n    'radius': config.radius || function (d) {\n      return d.value ? scale(d.value) : 1 + d.label.length;\n    },\n    'charge': config.charge || -500,\n    'distance': config.distance || 50,\n    'width': config.width || 1000,\n    'height': config.height || 750,\n    'label': config.label || false,\n    'selector': config.selector || null\n  };\n\n  let svg = d3sparql.select(opts.selector, 'forcegraph').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height);\n  let link = svg.selectAll('.link')\n    .data(graph.links)\n    .enter()\n    .append('line')\n    .attr('class', 'link');\n  let node = svg.selectAll('.node')\n    .data(graph.nodes)\n    .enter()\n    .append('g');\n  let circle = node.append('circle')\n    .attr('class', 'node')\n    .attr('r', opts.radius);\n  let text = node.append('text')\n    .text(function (d) {\n      return d[opts.label || 'label'];\n    })\n    .attr('class', 'node');\n  let force = d3.layout.force()\n    .charge(opts.charge)\n    .linkDistance(opts.distance)\n    .size([opts.width, opts.height])\n    .nodes(graph.nodes)\n    .links(graph.links)\n    .start();\n  force.on('tick', function () {\n    link.attr('x1', function (d) {\n        return d.source.x;\n      })\n      .attr('y1', function (d) {\n        return d.source.y;\n      })\n      .attr('x2', function (d) {\n        return d.target.x;\n      })\n      .attr('y2', function (d) {\n        return d.target.y;\n      });\n    text.attr('x', function (d) {\n        return d.x;\n      })\n      .attr('y', function (d) {\n        return d.y;\n      });\n    circle.attr('cx', function (d) {\n        return d.x;\n      })\n      .attr('cy', function (d) {\n        return d.y;\n      });\n  });\n  node.call(force.drag);\n\n  // default CSS/SVG\n  link.attr({\n    'stroke': '#999999',\n  });\n  circle.attr({\n    'stroke': 'black',\n    'stroke-width': '1px',\n    'fill': 'lightblue',\n    'opacity': 1,\n  });\n  text.attr({\n    'font-size': '8px',\n    'font-family': 'sans-serif',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a sanky graph\n\n  References:\n    https://github.com/d3/d3-plugins/tree/master/sankey\n    http://bost.ocks.org/mike/sankey/\n\n  Options:\n    config = {\n      \"width\":    1000,      // canvas width (optional)\n      \"height\":   900,       // canvas height (optional)\n      \"margin\":   50,        // canvas margin (optional)\n      \"selector\": \"#result\"\n      // options for d3sparql.graph() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.sankey(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .node rect {\n      cursor: move;\n      fill-opacity: .9;\n      shape-rendering: crispEdges;\n    }\n    .node text {\n      pointer-events: none;\n      text-shadow: 0 1px 0 #ffffff;\n    }\n    .link {\n      fill: none;\n      stroke: #000000;\n      stroke-opacity: .2;\n    }\n    .link:hover {\n      stroke-opacity: .5;\n    }\n    </style>\n\n  Dependencies:\n    * sankey.js\n      * Download from https://github.com/d3/d3-plugins/tree/master/sankey\n      * Put <script src=\"sankey.js\"></script> in the HTML <head> section\n*/\nd3sparql.sankey = function (json, config) {\n  config = config || {};\n\n  let graph = (json.head && json.results) ? d3sparql.graph(json, config) : json;\n\n  let opts = {\n    'width': config.width || 750,\n    'height': config.height || 1200,\n    'margin': config.margin || 10,\n    'selector': config.selector || null\n  };\n\n  let nodes = graph.nodes;\n  let links = graph.links;\n  for (let i = 0; i < links.length; i++) {\n    links[i].value = 2;  // TODO: fix to use values on links\n  }\n  let sankey = d3.sankey()\n    .size([opts.width, opts.height])\n    .nodeWidth(15)\n    .nodePadding(10)\n    .nodes(nodes)\n    .links(links)\n    .layout(32);\n  let path = sankey.link();\n  let color = d3.scale.category20();\n  let svg = d3sparql.select(opts.selector, 'sankey').append('svg')\n    .attr('width', opts.width + opts.margin * 2)\n    .attr('height', opts.height + opts.margin * 2)\n    .append('g')\n    .attr('transform', 'translate(' + opts.margin + ',' + opts.margin + ')');\n  let link = svg.selectAll('.link')\n    .data(links)\n    .enter()\n    .append('path')\n    .attr('class', 'link')\n    .attr('d', path)\n    .attr('stroke-width', function (d) {\n      return Math.max(1, d.dy);\n    })\n    .sort(function (a, b) {\n      return b.dy - a.dy;\n    });\n  let node = svg.selectAll('.node')\n    .data(nodes)\n    .enter()\n    .append('g')\n    .attr('class', 'node')\n    .attr('transform', function (d) {\n      return 'translate(' + d.x + ',' + d.y + ')';\n    })\n    .call(d3.behavior.drag()\n      .origin(function (d) {\n        return d;\n      })\n      .on('dragstart', function () {\n        this.parentNode.appendChild(this);\n      })\n      .on('drag', dragmove)\n    );\n  node.append('rect')\n    .attr('width', function (d) {\n      return d.dx;\n    })\n    .attr('height', function (d) {\n      return d.dy;\n    })\n    .attr('fill', function (d) {\n      return color(d.label);\n    })\n    .attr('opacity', 0.5);\n  node.append('text')\n    .attr('x', -6)\n    .attr('y', function (d) {\n      return d.dy / 2;\n    })\n    .attr('dy', '.35em')\n    .attr('text-anchor', 'end')\n    .attr('transform', null)\n    .text(function (d) {\n      return d.label;\n    })\n    .filter(function (d) {\n      return d.x < opts.width / 2;\n    })\n    .attr('x', 6 + sankey.nodeWidth())\n    .attr('text-anchor', 'start');\n\n  // default CSS/SVG\n  link.attr({\n    'fill': 'none',\n    'stroke': 'grey',\n    'opacity': 0.5,\n  });\n\n  function dragmove(d) {\n    d3.select(this).attr('transform', 'translate(' + d.x + ',' + (d.y = Math.max(0, Math.min(opts.height - d.dy, d3.event.y))) + ')');\n    sankey.relayout();\n    link.attr('d', path);\n  }\n};\n\n\n/*\n  Rendering sparql-results+json object into a round tree\n\n  References:\n    http://bl.ocks.org/4063550  Reingold-Tilford Tree\n\n  Options:\n    config = {\n      \"diameter\": 800,       // canvas diameter (optional)\n      \"angle\":    360,       // arc angle (optional; less than 360 for wedge)\n      \"depth\":    200,       // arc depth (optional; less than diameter/2 - label length to fit)\n      \"radius\":   5,         // node radius (optional)\n      \"selector\": \"#result\"\n      // options for d3sparql.tree() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.roundtree(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .link {\n      fill: none;\n      stroke: #cccccc;\n      stroke-width: 1.5px;\n    }\n    .node circle {\n      fill: #ffffff;\n      stroke: darkgreen;\n      stroke-width: 1.5px;\n      opacity: 1;\n    }\n    .node text {\n      font-size: 10px;\n      font-family: sans-serif;\n    }\n    </style>\n*/\nd3sparql.roundtree = function (json, config) {\n  config = config || {};\n\n  let tree = (json.head && json.results) ? d3sparql.tree(json, config) : json;\n\n  let opts = {\n    'diameter': config.diameter || 800,\n    'angle': config.angle || 360,\n    'depth': config.depth || 200,\n    'radius': config.radius || 5,\n    'selector': config.selector || null\n  };\n\n  let tree_layout = d3.layout.tree()\n    .size([opts.angle, opts.depth])\n    .separation(function (a, b) {\n      return (a.parent === b.parent ? 1 : 2) / a.depth;\n    });\n  let nodes = tree_layout.nodes(tree);\n  let links = tree_layout.links(nodes);\n  let diagonal = d3.svg.diagonal.radial()\n    .projection(function (d) {\n      return [d.y, d.x / 180 * Math.PI];\n    });\n  let svg = d3sparql.select(opts.selector, 'roundtree').append('svg')\n    .attr('width', opts.diameter)\n    .attr('height', opts.diameter)\n    .append('g')\n    .attr('transform', 'translate(' + opts.diameter / 2 + ',' + opts.diameter / 2 + ')');\n  let link = svg.selectAll('.link')\n    .data(links)\n    .enter()\n    .append('path')\n    .attr('class', 'link')\n    .attr('d', diagonal);\n  let node = svg.selectAll('.node')\n    .data(nodes)\n    .enter()\n    .append('g')\n    .attr('class', 'node')\n    .attr('transform', function (d) {\n      return 'rotate(' + (d.x - 90) + ') translate(' + d.y + ')';\n    });\n  let circle = node.append('circle')\n    .attr('r', opts.radius);\n  let text = node.append('text')\n    .attr('dy', '.35em')\n    .attr('text-anchor', function (d) {\n      return d.x < 180 ? 'start' : 'end';\n    })\n    .attr('transform', function (d) {\n      return d.x < 180 ? 'translate(8)' : 'rotate(180) translate(-8)';\n    })\n    .text(function (d) {\n      return d.name;\n    });\n\n  // default CSS/SVG\n  link.attr({\n    'fill': 'none',\n    'stroke': '#cccccc',\n    'stroke-width': '1.5px',\n  });\n  circle.attr({\n    'fill': '#ffffff',\n    'stroke': 'steelblue',\n    'stroke-width': '1.5px',\n    'opacity': 1,\n  });\n  text.attr({\n    'font-size': '10px',\n    'font-family': 'sans-serif',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a dendrogram\n\n  References:\n    http://bl.ocks.org/4063570  Cluster Dendrogram\n\n  Options:\n    config = {\n      \"width\":    900,       // canvas width (optional)\n      \"height\":   4500,      // canvas height (optional)\n      \"margin\":   300,       // width margin for labels (optional)\n      \"radius\":   5,         // radius of node circles (optional)\n      \"selector\": \"#result\"\n      // options for d3sparql.tree() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.dendrogram(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .link {\n      fill: none;\n      stroke: #cccccc;\n      stroke-width: 1.5px;\n    }\n    .node circle {\n      fill: #ffffff;\n      stroke: steelblue;\n      stroke-width: 1.5px;\n      opacity: 1;\n    }\n    .node text {\n      font-size: 10px;\n      font-family: sans-serif;\n    }\n    </style>\n*/\nd3sparql.dendrogram = function (json, config) {\n  config = config || {};\n\n  let tree = (json.head && json.results) ? d3sparql.tree(json, config) : json;\n\n  let opts = {\n    'width': config.width || 800,\n    'height': config.height || 2000,\n    'margin': config.margin || 350,\n    'radius': config.radius || 5,\n    'selector': config.selector || null\n  };\n\n  let cluster = d3.layout.cluster()\n    .size([opts.height, opts.width - opts.margin]);\n  let diagonal = d3.svg.diagonal()\n    .projection(function (d) {\n      return [d.y, d.x];\n    });\n  let svg = d3sparql.select(opts.selector, 'dendrogram').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height)\n    .append('g')\n    .attr('transform', 'translate(40,0)');\n  let nodes = cluster.nodes(tree);\n  let links = cluster.links(nodes);\n  let link = svg.selectAll('.link')\n    .data(links)\n    .enter().append('path')\n    .attr('class', 'link')\n    .attr('d', diagonal);\n  let node = svg.selectAll('.node')\n    .data(nodes)\n    .enter().append('g')\n    .attr('class', 'node')\n    .attr('transform', function (d) {\n      return 'translate(' + d.y + ',' + d.x + ')';\n    });\n  let circle = node.append('circle')\n    .attr('r', opts.radius);\n  let text = node.append('text')\n    .attr('dx', function (d) {\n      return (d.parent && d.children) ? -8 : 8;\n    })\n    .attr('dy', 5)\n    .style('text-anchor', function (d) {\n      return (d.parent && d.children) ? 'end' : 'start';\n    })\n    .text(function (d) {\n      return d.name;\n    });\n\n  // default CSS/SVG\n  link.attr({\n    'fill': 'none',\n    'stroke': '#cccccc',\n    'stroke-width': '1.5px',\n  });\n  circle.attr({\n    'fill': '#ffffff',\n    'stroke': 'steelblue',\n    'stroke-width': '1.5px',\n    'opacity': 1,\n  });\n  text.attr({\n    'font-size': '10px',\n    'font-family': 'sans-serif',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a sunburst\n\n  References:\n    http://bl.ocks.org/4348373  Zoomable Sunburst\n    http://www.jasondavies.com/coffee-wheel/  Coffee Flavour Wheel\n\n  Options:\n    config = {\n      \"width\":    1000,      // canvas width (optional)\n      \"height\":   900,       // canvas height (optional)\n      \"margin\":   150,       // margin for labels (optional)\n      \"selector\": \"#result\"\n      // options for d3sparql.tree() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.sunburst(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .node text {\n      font-size: 10px;\n      font-family: sans-serif;\n    }\n    .arc {\n      stroke: #ffffff;\n      fill-rule: evenodd;\n    }\n    </style>\n*/\nd3sparql.sunburst = function (json, config = {}) {\n  let tree = (json.head && json.results) ? d3sparql.tree(json, config) : json;\n\n  let opts = {\n    'width': config.width || 1000,\n    'height': config.height || 900,\n    'margin': config.margin || 150,\n    'selector': config.selector || null\n  };\n\n  let radius = Math.min(opts.width, opts.height) / 2 - opts.margin;\n  let x = d3.scale.linear().range([0, 2 * Math.PI]);\n  let y = d3.scale.sqrt().range([0, radius]);\n  let color = d3.scale.category20();\n  let svg = d3sparql.select(opts.selector, 'sunburst').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height)\n    .append('g')\n    .attr('transform', 'translate(' + opts.width / 2 + ',' + opts.height / 2 + ')');\n  let arc = d3.svg.arc()\n    .startAngle(function (d) {\n      return Math.max(0, Math.min(2 * Math.PI, x(d.x)));\n    })\n    .endAngle(function (d) {\n      return Math.max(0, Math.min(2 * Math.PI, x(d.x + d.dx)));\n    })\n    .innerRadius(function (d) {\n      return Math.max(0, y(d.y));\n    })\n    .outerRadius(function (d) {\n      return Math.max(0, y(d.y + d.dy));\n    });\n  let partition = d3.layout.partition()\n    .value(function (d) {\n      return d.value;\n    });\n  let nodes = partition.nodes(tree);\n  let path = svg.selectAll('path')\n    .data(nodes)\n    .enter()\n    .append('path')\n    .attr('d', arc)\n    .attr('class', 'arc')\n    .style('fill', function (d) {\n      return color((d.children ? d : d.parent).name);\n    })\n    .on('click', click);\n  let text = svg.selectAll('text')\n    .data(nodes)\n    .enter()\n    .append('text')\n    .attr('transform', function (d) {\n      let rotate = x(d.x + d.dx / 2) * 180 / Math.PI - 90;\n      return 'rotate(' + rotate + ') translate(' + y(d.y) + ')';\n    })\n    .attr('dx', '.5em')\n    .attr('dy', '.35em')\n    .text(function (d) {\n      return d.name;\n    })\n    .on('click', click);\n\n  // default CSS/SVG\n  path.attr({\n    'stroke': '#ffffff',\n    'fill-rule': 'evenodd',\n  });\n  text.attr({\n    'font-size': '10px',\n    'font-family': 'sans-serif',\n  });\n\n  function click(d) {\n    path.transition()\n      .duration(750)\n      .attrTween('d', arcTween(d));\n    text.style('visibility', function (e) {\n        // required for showing labels just before the transition when zooming back to the upper level\n        return isParentOf(d, e) ? null : d3.select(this).style('visibility');\n      })\n      .transition()\n      .duration(750)\n      .attrTween('transform', function (d) {\n        return function () {\n          let rotate = x(d.x + d.dx / 2) * 180 / Math.PI - 90;\n          return 'rotate(' + rotate + ') translate(' + y(d.y) + ')';\n        };\n      })\n      .each('end', function (e) {\n        // required for hiding labels just after the transition when zooming down to the lower level\n        d3.select(this).style('visibility', isParentOf(d, e) ? null : 'hidden');\n      });\n  }\n\n  function maxDepth(d) {\n    return d.children ? Math.max.apply(Math, d.children.map(maxDepth)) : d.y + d.dy;\n  }\n\n  function arcTween(d) {\n    let xd = d3.interpolate(x.domain(), [d.x, d.x + d.dx]),\n      yd = d3.interpolate(y.domain(), [d.y, maxDepth(d)]),\n      yr = d3.interpolate(y.range(), [d.y ? 20 : 0, radius]);\n    return function (d) {\n      return function (t) {\n        x.domain(xd(t));\n        y.domain(yd(t)).range(yr(t));\n        return arc(d);\n      };\n    };\n  }\n\n  function isParentOf(p, c) {\n    if (p === c) return true;\n    if (p.children) {\n      return p.children.some(function (d) {\n        return isParentOf(d, c);\n      });\n    }\n    return false;\n  }\n};\n\n/*\n  Rendering sparql-results+json object into a circle pack\n\n  References:\n    http://mbostock.github.com/d3/talk/20111116/pack-hierarchy.html  Circle Packing\n\n  Options:\n    config = {\n      \"width\":    800,       // canvas width (optional)\n      \"height\":   800,       // canvas height (optional)\n      \"diameter\": 700,       // diamieter of the outer circle (optional)\n      \"selector\": \"#result\"\n      // options for d3sparql.tree() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.circlepack(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    text {\n      font-size: 11px;\n      pointer-events: none;\n    }\n    text.parent {\n      fill: #1f77b4;\n    }\n    circle {\n      fill: #cccccc;\n      stroke: #999999;\n      pointer-events: all;\n    }\n    circle.parent {\n      fill: #1f77b4;\n      fill-opacity: .1;\n      stroke: steelblue;\n    }\n    circle.parent:hover {\n      stroke: #ff7f0e;\n      stroke-width: .5px;\n    }\n    circle.child {\n      pointer-events: none;\n    }\n    </style>\n\n  TODO:\n    Fix rotation angle for each text to avoid string collision\n*/\nd3sparql.circlepack = function (json, config) {\n  config = config || {};\n\n  let tree = (json.head && json.results) ? d3sparql.tree(json, config) : json;\n\n  let opts = {\n    'width': config.width || 800,\n    'height': config.height || 800,\n    'diameter': config.diameter || 700,\n    'selector': config.selector || null\n  };\n\n  let w = opts.width,\n    h = opts.height,\n    r = opts.diameter,\n    x = d3.scale.linear().range([0, r]),\n    y = d3.scale.linear().range([0, r]);\n\n  let pack = d3.layout.pack()\n    .size([r, r])\n    .value(function (d) {\n      return d.value;\n    });\n\n  let node = tree;\n  let nodes = pack.nodes(tree);\n\n  let vis = d3sparql.select(opts.selector, 'circlepack').append('svg')\n    .attr('width', w)\n    .attr('height', h)\n    .append('g')\n    .attr('transform', 'translate(' + (w - r) / 2 + ',' + (h - r) / 2 + ')');\n\n  vis.selectAll('circle')\n    .data(nodes)\n    .enter()\n    .append('circle')\n    .attr('class', function (d) {\n      return d.children ? 'parent' : 'child';\n    })\n    .attr('cx', function (d) {\n      return d.x;\n    })\n    .attr('cy', function (d) {\n      return d.y;\n    })\n    .attr('r', function (d) {\n      return d.r;\n    })\n    /*\n        // CSS: circle { ... }\n        .attr(\"fill\", function(d) { return d.children ? \"#1f77b4\" : \"#cccccc\" })\n        .attr(\"fill-opacity\", function(d) { return d.children ? \".1\" : \"1\" })\n        .attr(\"stroke\", function(d) { return d.children ? \"steelblue\" : \"#999999\" })\n        .attr(\"pointer-events\", function(d) { return d.children ? \"all\" : \"none\" })\n        .on(\"mouseover\", function() { d3.select(this).attr(\"stroke\", \"#ff7f0e\").attr(\"stroke-width\", \".5px\") })\n        .on(\"mouseout\", function() { d3.select(this).attr(\"stroke\", \"steelblue\").attr(\"stroke-width\", \".5px\") })\n    */\n    .on('click', function (d) {\n      return zoom(node === d ? tree : d);\n    });\n\n  vis.selectAll('text')\n    .data(nodes)\n    .enter()\n    .append('text')\n    .attr('class', function (d) {\n      return d.children ? 'parent' : 'child';\n    })\n    .attr('x', function (d) {\n      return d.x;\n    })\n    .attr('y', function (d) {\n      return d.y;\n    })\n    //    .attr(\"dy\", \".35em\")\n    .style('opacity', function (d) {\n      return d.r > 20 ? 1 : 0;\n    })\n    .text(function (d) {\n      return d.name;\n    })\n    // rotate to avoid string collision\n    //.attr(\"text-anchor\", \"middle\")\n    .attr('text-anchor', 'start')\n    .transition()\n    .duration(1000)\n    .attr('transform', function (d) {\n      return 'rotate(-30, ' + d.x + ', ' + d.y + ')';\n    });\n\n  d3.select(window).on('click', function () {\n    zoom(tree);\n  });\n\n  function zoom(d, i) {\n    let k = r / d.r / 2;\n    x.domain([d.x - d.r, d.x + d.r]);\n    y.domain([d.y - d.r, d.y + d.r]);\n    let t = vis.transition()\n      .duration(d3.event.altKey ? 2000 : 500);\n    t.selectAll('circle')\n      .attr('cx', function (d) {\n        return x(d.x);\n      })\n      .attr('cy', function (d) {\n        return y(d.y);\n      })\n      .attr('r', function (d) {\n        return k * d.r;\n      });\n    t.selectAll('text')\n      .attr('x', function (d) {\n        return x(d.x);\n      })\n      .attr('y', function (d) {\n        return y(d.y);\n      })\n      .style('opacity', function (d) {\n        return k * d.r > 20 ? 1 : 0;\n      });\n    d3.event.stopPropagation();\n  }\n};\n\n/*\n  Rendering sparql-results+json object into a treemap\n\n  References:\n    http://bl.ocks.org/4063582  Treemap\n\n  Options:\n    config = {\n      \"width\":    800,       // canvas width (optional)\n      \"height\":   500,       // canvas height (optional)\n      \"margin\":   {\"top\": 10, \"right\": 10, \"bottom\": 10, \"left\": 10},\n      \"selector\": \"#result\"\n      // options for d3sparql.tree() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.treemap(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .node {\n      border: solid 1px white;\n      font: 10px sans-serif;\n      line-height: 12px;\n      overflow: hidden;\n      position: absolute;\n      text-indent: 2px;\n    }\n    </style>\n*/\nd3sparql.treemap = function (json, config = {}) {\n  let tree = (json.head && json.results) ? d3sparql.tree(json, config) : json;\n\n  let opts = {\n    'width': config.width || 800,\n    'height': config.height || 500,\n    'count': config.count || false,\n    'color': config.color || d3.scale.category20c(),\n    'margin': config.margin || { top: 0, right: 0, bottom: 0, left: 0 },\n    'selector': config.selector || null\n  };\n\n  let width = opts.width - opts.margin.left - opts.margin.right;\n  let height = opts.height - opts.margin.top - opts.margin.bottom;\n  let color = opts.color;\n\n  function count(d) {\n    return 1;\n  }\n\n  function size(d) {\n    return d.value;\n  }\n\n  let treemap = d3.layout.treemap()\n    .size([width, height])\n    .sticky(true)\n    .value(opts.count ? count : size);\n\n  let div = d3sparql.select(opts.selector, 'treemap')\n    .style('position', 'relative')\n    .style('width', opts.width + 'px')\n    .style('height', opts.height + 'px')\n    .style('left', opts.margin.left + 'px')\n    .style('top', opts.margin.top + 'px');\n\n  let node = div.datum(tree).selectAll('.node')\n    .data(treemap.nodes)\n    .enter()\n    .append('div')\n    .attr('class', 'node')\n    .call(position)\n    .style('background', function (d) {\n      return d.children ? color(d.name) : null;\n    })\n    .text(function (d) {\n      return d.children ? null : d.name;\n    });\n\n  // default CSS/SVG\n  node.style({\n    'border-style': 'solid',\n    'border-width': '1px',\n    'border-color': 'white',\n    'font-size': '10px',\n    'font-family': 'sans-serif',\n    'line-height': '12px',\n    'overflow': 'hidden',\n    'position': 'absolute',\n    'text-indent': '2px',\n  });\n\n  function position() {\n    this.style('left', function (d) {\n        return d.x + 'px';\n      })\n      .style('top', function (d) {\n        return d.y + 'px';\n      })\n      .style('width', function (d) {\n        return Math.max(0, d.dx - 1) + 'px';\n      })\n      .style('height', function (d) {\n        return Math.max(0, d.dy - 1) + 'px';\n      });\n  }\n};\n\n/*\n  Rendering sparql-results+json object into a zoomable treemap\n\n  References:\n    http://bost.ocks.org/mike/treemap/  Zoomable Treemaps\n    http://bl.ocks.org/zanarmstrong/76d263bd36f312cb0f9f\n\n  Options:\n    config = {\n      \"width\":    800,       // canvas width (optional)\n      \"height\":   500,       // canvas height (optional)\n      \"margin\":   {\"top\": 10, \"right\": 10, \"bottom\": 10, \"left\": 10},\n      \"selector\": \"#result\"\n      // options for d3sparql.tree() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.treemapzoom(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    rect {\n      cursor: pointer;\n    }\n    .grandparent:hover rect {\n      opacity: 0.8;\n    }\n    .children:hover rect.child {\n      opacity: 0.2;\n    }\n    </style>\n*/\nd3sparql.treemapzoom = function (json, config) {\n  config = config || {};\n\n  let tree = (json.head && json.results) ? d3sparql.tree(json, config) : json;\n\n  let opts = {\n    'width': config.width || 800,\n    'height': config.height || 500,\n    'margin': config.margin || { top: 25, right: 0, bottom: 0, left: 0 },\n    'color': config.color || d3.scale.category20(),\n    'format': config.format || d3.format(',d'),\n    'selector': config.selector || null\n  };\n\n  let width = opts.width - opts.margin.left - opts.margin.right;\n  let height = opts.height - opts.margin.top - opts.margin.bottom;\n  let color = opts.color;\n  let format = opts.format;\n  let transitioning;\n\n  let x = d3.scale.linear().domain([0, width]).range([0, width]);\n  let y = d3.scale.linear().domain([0, height]).range([0, height]);\n\n  let treemap = d3.layout.treemap()\n    .children(function (d, depth) {\n      return depth ? null : d.children;\n    })\n    .sort(function (a, b) {\n      return a.value - b.value;\n    })\n    .ratio(height / width * 0.5 * (1 + Math.sqrt(5)))\n    .round(false);\n\n  let svg = d3sparql.select(opts.selector, 'treemapzoom').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height)\n    .style('margin-left', -opts.margin.left + 'px')\n    .style('margin.right', -opts.margin.right + 'px')\n    .append('g')\n    .attr('transform', 'translate(' + opts.margin.left + ',' + opts.margin.top + ')')\n    .style('shape-rendering', 'crispEdges');\n\n  let grandparent = svg.append('g')\n    .attr('class', 'grandparent');\n\n  grandparent.append('rect')\n    .attr('y', -opts.margin.top)\n    .attr('width', width)\n    .attr('height', opts.margin.top)\n    .attr('fill', '#666666');\n\n  grandparent.append('text')\n    .attr('x', 6)\n    .attr('y', 6 - opts.margin.top)\n    .attr('dy', '.75em')\n    .attr('stroke', '#ffffff')\n    .attr('fill', '#ffffff');\n\n  initialize(tree);\n  layout(tree);\n  display(tree);\n\n  function initialize(tree) {\n    tree.x = tree.y = 0;\n    tree.dx = width;\n    tree.dy = height;\n    tree.depth = 0;\n  }\n\n  // Compute the treemap layout recursively such that each group of siblings\n  // uses the same size (11) rather than the dimensions of the parent cell.\n  // This optimizes the layout for the current zoom state. Note that a wrapper\n  // object is created for the parent node for each group of siblings so that\n  // the parents dimensions are not discarded as we recurse. Since each group\n  // of sibling was laid out in 11, we must rescale to fit using absolute\n  // coordinates. This lets us use a viewport to zoom.\n  function layout(d) {\n    if (d.children) {\n      treemap.nodes({ children: d.children });\n      d.children.forEach(function (c) {\n        c.x = d.x + c.x * d.dx;\n        c.y = d.y + c.y * d.dy;\n        c.dx *= d.dx;\n        c.dy *= d.dy;\n        c.parent = d;\n        layout(c);\n      });\n    }\n  }\n\n  function display(d) {\n    grandparent\n      .datum(d.parent)\n      .on('click', transition)\n      .select('text')\n      .text(name(d));\n\n    let g1 = svg.insert('g', '.grandparent')\n      .datum(d)\n      .attr('class', 'depth');\n\n    let g = g1.selectAll('g')\n      .data(d.children)\n      .enter()\n      .append('g');\n\n    g.filter(function (d) {\n        return d.children;\n      })\n      .classed('children', true)\n      .on('click', transition);\n\n    g.selectAll('.child')\n      .data(function (d) {\n        return d.children || [d];\n      })\n      .enter()\n      .append('rect')\n      .attr('class', 'child')\n      .call(rect);\n\n    g.append('rect')\n      .attr('class', 'parent')\n      .call(rect)\n      .append('title')\n      .text(function (d) {\n        return format(d.value);\n      });\n\n    g.append('text')\n      .attr('dy', '.75em')\n      .text(function (d) {\n        return d.name;\n      })\n      .call(text);\n\n    function transition(d) {\n      if (transitioning || !d) return;\n      transitioning = true;\n      let g2 = display(d),\n        t1 = g1.transition().duration(750),\n        t2 = g2.transition().duration(750);\n\n      // Update the domain only after entering new elements.\n      x.domain([d.x, d.x + d.dx]);\n      y.domain([d.y, d.y + d.dy]);\n\n      // Enable anti-aliasing during the transition.\n      svg.style('shape-rendering', null);\n\n      // Draw child nodes on top of parent nodes.\n      svg.selectAll('.depth').sort(function (a, b) {\n        return a.depth - b.depth;\n      });\n\n      // Fade-in entering text.\n      g2.selectAll('text').style('fill-opacity', 0);\n\n      // Transition to the new view.\n      t1.selectAll('text').call(text).style('fill-opacity', 0);\n      t2.selectAll('text').call(text).style('fill-opacity', 1);\n      t1.selectAll('rect').call(rect);\n      t2.selectAll('rect').call(rect);\n\n      // Remove the old node when the transition is finished.\n      t1.remove().each('end', function () {\n        svg.style('shape-rendering', 'crispEdges');\n        transitioning = false;\n      });\n    }\n\n    return g;\n  }\n\n  function text(text) {\n    text.attr('x', function (d) {\n        return x(d.x) + 6;\n      })\n      .attr('y', function (d) {\n        return y(d.y) + 6;\n      });\n  }\n\n  function rect(rect) {\n    rect.attr('x', function (d) {\n        return x(d.x);\n      })\n      .attr('y', function (d) {\n        return y(d.y);\n      })\n      .attr('width', function (d) {\n        return x(d.x + d.dx) - x(d.x);\n      })\n      .attr('height', function (d) {\n        return y(d.y + d.dy) - y(d.y);\n      })\n      .attr('fill', function (d) {\n        return color(d.name);\n      });\n    rect.attr({\n      'stroke': '#ffffff',\n      'stroke-width': '1px',\n      'opacity': 0.8,\n    });\n  }\n\n  function name(d) {\n    return d.parent\n      ? name(d.parent) + ' / ' + d.name\n      : d.name;\n  }\n};\n\n/*\n  World Map spotted by coordinations (longitude and latitude)\n\n  Options:\n    config = {\n      \"let_lat\":  \"lat\",     // SPARQL letiable name for latitude (optional; default is the 1st letiable)\n      \"let_lng\":  \"lng\",     // SPARQL letiable name for longitude (optional; default is the 2nd letiable)\n      \"width\":    960,       // canvas width (optional)\n      \"height\":   480,       // canvas height (optional)\n      \"radius\":   5,         // circle radius (optional)\n      \"color\":    \"#FF3333,  // circle color (optional)\n      \"topojson\": \"path/to/world-50m.json\",  // TopoJSON file\n      \"selector\": \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      d3sparql.coordmap(json, config = {})\n    }\n\n  Dependencies:\n    * topojson.js\n      * Download from http://d3js.org/topojson.v1.min.js\n      * Put <script src=\"topojson.js\"></script> in the HTML <head> section\n    * world-50m.json\n      * Download from https://github.com/mbostock/topojson/blob/master/examples/world-50m.json\n*/\nd3sparql.coordmap = function (json, config) {\n  config = config || {};\n\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'let_lat': config.let_lat || head[0] || 'lat',\n    'let_lng': config.let_lng || head[1] || 'lng',\n    'width': config.width || 960,\n    'height': config.height || 480,\n    'radius': config.radius || 5,\n    'color': config.color || '#FF3333',\n    'topojson': config.topojson || 'world-50m.json',\n    'selector': config.selector || null\n  };\n\n  let projection = d3.geo.equirectangular()\n    .scale(153)\n    .translate([opts.width / 2, opts.height / 2])\n    .precision(.1);\n  let path = d3.geo.path()\n    .projection(projection);\n  let graticule = d3.geo.graticule();\n  let svg = d3sparql.select(opts.selector, 'coordmap').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height);\n\n  svg.append('path')\n    .datum(graticule.outline)\n    .attr('fill', '#a4bac7')\n    .attr('d', path);\n\n  svg.append('path')\n    .datum(graticule)\n    .attr('fill', 'none')\n    .attr('stroke', '#333333')\n    .attr('stroke-width', '.5px')\n    .attr('stroke-opacity', '.5')\n    .attr('d', path);\n\n  d3.json(opts.topojson, function (error, world) {\n    svg.insert('path', '.graticule')\n      .datum(topojson.feature(world, world.objects.land))\n      .attr('fill', '#d7c7ad')\n      .attr('stroke', '#766951')\n      .attr('d', path);\n\n    svg.insert('path', '.graticule')\n      .datum(topojson.mesh(world, world.objects.countries, function (a, b) {\n        return a !== b;\n      }))\n      .attr('class', 'boundary')\n      .attr('fill', 'none')\n      .attr('stroke', '#a5967e')\n      .attr('stroke-width', '.5px')\n      .attr('d', path);\n\n    svg.selectAll('.pin')\n      .data(data)\n      .enter().append('circle', '.pin')\n      .attr('fill', opts.color)\n      .attr('r', opts.radius)\n      .attr('stroke', '#455346')\n      .attr('transform', function (d) {\n        return 'translate(' + projection([\n          d[opts.let_lng].value,\n          d[opts.let_lat].value\n        ]) + ')';\n      });\n  });\n};\n\n/*\n  World Map colored by location names defined in a TopoJSON file\n\n  Options:\n    config = {\n      \"label\":       \"name\",    // SPARQL letiable name for location names (optional; default is the 1st letiable)\n      \"value\":       \"size\",    // SPARQL letiable name for numerical values (optional; default is the 2nd letiable)\n      \"width\":       1000,      // canvas width (optional)\n      \"height\":      1000,      // canvas height (optional)\n      \"color_max\":   \"blue\",    // color for maximum value (optional)\n      \"color_min\":   \"white\",   // color for minimum value (optional)\n      \"color_scale\": \"linear\"   // color scale (optional; \"linear\" or \"log\")\n      \"topojson\":    \"path/to/japan.topojson\",  // TopoJSON file\n      \"mapname\":     \"japan\",   // JSON key name of a map location root (e.g., \"objects\":{\"japan\":{\"type\":\"GeometryCollection\", ...)\n      \"keyname\":     \"name\",    // JSON key name of map locations matched with \"label\" (e.g., \"properties\":{\"name\":\"Tokyo\", ...)\n      \"center_lat\":  34,        // latitude for a map location center (optional; default is 34 for Japan)\n      \"center_lng\":  137,       // longitude for a map location center (optional; default is 137 for Japan)\n      \"scale\":       10000,     // scale of rendering (optional)\n      \"selector\":    \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      d3sparql.namedmap(json, config = {})\n    }\n\n  Dependencies:\n    * topojson.js\n      * Download from http://d3js.org/topojson.v1.min.js\n      * Put <script src=\"topojson.js\"></script> in the HTML <head> section\n    * japan.topojson\n      * Download from https://github.com/sparql-book/sparql-book/blob/master/chapter5/D3/japan.topojson\n*/\nd3sparql.namedmap = function (json, config) {\n  config = config || {};\n\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'label': config.label || head[0] || 'label',\n    'value': config.value || head[1] || 'value',\n    'width': config.width || 1000,\n    'height': config.height || 1000,\n    'color_max': config.color_max || 'red',\n    'color_min': config.color_min || 'white',\n    'color_scale': config.color_scale || 'log',\n    'topojson': config.topojson || 'japan.topojson',\n    'mapname': config.mapname || 'japan',\n    'keyname': config.keyname || 'name_local',\n    'center_lat': config.center_lat || 34,\n    'center_lng': config.center_lng || 137,\n    'scale': config.scale || 10000,\n    'selector': config.selector || null\n  };\n\n  let size = d3.nest()\n    .key(function (d) {\n      return d[opts.label].value;\n    })\n    .rollup(function (d) {\n      return d3.sum(d, function (d) {\n        return parseInt(d[opts.value].value);\n      });\n    }).map(data, d3.map);\n  let extent = d3.extent((d3.map(size).values()));\n\n  debug(() => JSON.stringify(size));\n\n  let svg = d3sparql.select(opts.selector, 'namedmap').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height);\n\n  d3.json(opts.topojson, function (topojson_map) {\n    let geo = topojson.object(topojson_map, topojson_map.objects[opts.mapname]).geometries;\n    let projection = d3.geo.mercator()\n      .center([opts.center_lng, opts.center_lat])\n      .translate([opts.width / 2, opts.height / 2])\n      .scale(opts.scale);\n    let path = d3.geo.path().projection(projection);\n    let scale;\n    switch (opts.color_scale) {\n      case 'log':\n        scale = d3.scale.log();\n        break;\n      default:\n        scale = d3.scale.linear();\n        break;\n    }\n    let color = scale.domain(extent).range([opts.color_min, opts.color_max]);\n\n    svg.selectAll('path')\n      .data(geo)\n      .enter()\n      .append('path')\n      .attr('d', path)\n      .attr('stroke', 'black')\n      .attr('stroke-width', 0.5)\n      .style('fill', function (d, i) {\n        // map SPARQL results to colors\n        return color(size[d.properties[opts.keyname]]);\n      });\n\n    svg.selectAll('.place-label')\n      .data(geo)\n      .enter()\n      .append('text')\n      .attr('font-size', '8px')\n      .attr('class', 'place-label')\n      .attr('transform', function (d) {\n        let lat = d.properties.latitude;\n        let lng = d.properties.longitude;\n        return 'translate(' + projection([lng, lat]) + ')';\n      })\n      .attr('dx', '-1.5em')\n      .text(function (d) {\n        return d.properties[opts.keyname];\n      });\n  });\n};\n\n/**\n * @param {string|EventTarget} selector\n * @param {string} type\n * @returns {d3.Selection<any>}\n */\nd3sparql.select = function (selector, type) {\n  if (selector) {\n    return d3.select(selector).html('').append('div').attr('class', 'd3sparql ' + type);\n  } else {\n    return d3.select('body').append('div').attr('class', 'd3sparql ' + type);\n  }\n};\n\n/* Helper function only for the d3sparql web site */\nd3sparql.toggle = function () {\n  let button = d3.select('#button');\n  let elem = d3.select('#sparql');\n  if (elem.style('display') === 'none') {\n    elem.style('display', 'inline');\n    button.attr('class', 'icon-chevron-up');\n  } else {\n    elem.style('display', 'none');\n    button.attr('class', 'icon-chevron-down');\n  }\n};\n\n/* for IFRAME embed */\nd3sparql.frameheight = function (height) {\n  d3.select(self.frameElement).style('height', height + 'px');\n};\n\nexport default d3sparql;\n"],"names":["d3sparql","version","debug","messageGetter","console","JSON","stringify","fetch","url","callback","mime","d3","xhr","request","json","responseText","parse","query","endpoint","sparql","encodeURIComponent","graph","config","head","lets","data","results","bindings","opts","key1","key2","label1","label2","value1","value2","check","map","index","i","length","value","has","nodes","push","set","links","get","tree","root","parent","child","pair","size","datum","children","traverse","node","list","d","subtotal","sum","total","htmltable","columns","selector","limit","offset","undefined","slice","table","select","append","attr","thead","tbody","selectAll","enter","text","col","rows","cells","row","val","style","htmlhash","barchart","label_x","label_y","let_x","let_y","width","height","margin","scale_x","scale","ordinal","rangeRoundBands","scale_y","linear","range","axis_x","svg","axis","orient","axis_y","domain","extent","parseInt","ax","call","ay","bar","rangeBand","piechart","label","hole","radius","Math","min","max","color","category20","arc","outerRadius","innerRadius","pie","layout","g","centroid","scatterplot","label_r","let_r","min_r","max_r","margin_x","margin_y","extent_x","extent_y","extent_r","scale_r","circle","forcegraph","parseFloat","charge","distance","link","force","linkDistance","start","on","source","x","y","target","drag","sankey","nodeWidth","nodePadding","path","dy","sort","a","b","behavior","origin","parentNode","appendChild","dragmove","dx","filter","event","relayout","roundtree","diameter","angle","depth","tree_layout","separation","diagonal","radial","projection","PI","name","dendrogram","cluster","sunburst","sqrt","startAngle","endAngle","partition","click","rotate","transition","duration","attrTween","arcTween","e","isParentOf","each","maxDepth","apply","xd","interpolate","yd","yr","t","p","c","some","circlepack","w","h","r","pack","vis","zoom","window","k","altKey","stopPropagation","treemap","count","category20c","top","right","bottom","left","sticky","div","position","treemapzoom","format","transitioning","ratio","round","grandparent","initialize","display","forEach","g1","insert","classed","rect","g2","t1","t2","remove","coordmap","let_lat","let_lng","topojson","geo","equirectangular","translate","precision","graticule","outline","error","world","feature","objects","land","mesh","countries","namedmap","color_max","color_min","color_scale","mapname","keyname","center_lat","center_lng","nest","key","rollup","values","topojson_map","object","geometries","mercator","center","log","properties","lat","latitude","lng","longitude","type","html","toggle","button","elem","frameheight","self","frameElement"],"mappings":"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"}