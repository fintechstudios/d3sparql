{"version":3,"file":"d3sparql.amd.js","sources":["../d3sparql.js"],"sourcesContent":["//\n// d3sparql.js - utilities for visualizing SPARQL results with the D3 library\n//\n//   Web site: http://github.com/ktym/d3sparql/\n//   Copyright: 2013-2015 (C) Toshiaki Katayama (ktym@dbcls.jp)\n//   License: BSD license (same as D3.js)\n//   Initial version: 2013-01-28\n//\n\nimport d3 from 'd3';\nimport * as topojson from 'topojson-client';\n\nconst d3sparql = {\n  version: 'd3sparql.js version 2020-04-25',\n  debug: false  // set to true for showing debug information\n};\n\nexport default d3sparql;\n\n/**\n * @param {*} message\n */\nfunction debug(message) {\n  if (d3sparql.debug) {\n    switch (typeof message) {\n      case 'object':\n        console.debug(JSON.stringify(message));\n        break;\n      default:\n        console.debug(message);\n    }\n  }\n}\n\n/**\n * Execute a SPARQL query\n * @param {string} url\n*/\nd3sparql.fetch = async (url) => {\n  debug(url);\n  const res = await fetch(url, {\n    headers: {\n      Accept: 'application/sparql-results+json',\n    }\n  });\n\n  if (!res.ok) {\n    throw new Error(await res.text());\n  }\n  return res.json();\n};\n\n/**\n * @param {string} endpoint\n * @param {string} sparql\n * @returns {Promise<object>}\n */\nd3sparql.query = function (endpoint, sparql) {\n  return d3sparql.fetch(`${url}?query=${encodeURIComponent(sparql)}`);\n};\n\n\n/*\n  Convert sparql-results+json object into a JSON graph in the {\"nodes\": [], \"links\": []} form.\n  Suitable for d3.layout.force(), d3.layout.sankey() etc.\n\n  Options:\n    config = {\n      \"key1\":   \"node1\",       // SPARQL letiable name for node1 (optional; default is the 1st letiable)\n      \"key2\":   \"node2\",       // SPARQL letiable name for node2 (optional; default is the 2nd letibale)\n      \"label1\": \"node1label\",  // SPARQL letiable name for the label of node1 (optional; default is the 3rd letiable)\n      \"label2\": \"node2label\",  // SPARQL letiable name for the label of node2 (optional; default is the 4th letiable)\n      \"value1\": \"node1value\",  // SPARQL letiable name for the value of node1 (optional; default is the 5th letiable)\n      \"value2\": \"node2value\"   // SPARQL letiable name for the value of node2 (optional; default is the 6th letiable)\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.forcegraph(json, config)\n      d3sparql.sankey(json, config)\n    }\n\n  TODO:\n    Should follow the convention in the miserables.json https://gist.github.com/mbostock/4062045 to contain group for nodes and value for edges.\n*/\nd3sparql.graph = function (json, config = {}) {\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  const key1 = config.key1 || head[0] || 'key1';\n  const key2 = config.key2 || head[1] || 'key2';\n  const label1 = config.label1 || head[2] || false;\n  const label2 = config.label2 || head[3] || false;\n  const value1 = config.value1 || head[4] || false;\n  const value2 = config.value2 || head[5] || false;\n\n  let graph = {\n    'nodes': [],\n    'links': []\n  };\n  let check = new Map();\n  let index = 0;\n  for (let i = 0; i < data.length; i++) {\n    let datum = data[i];\n    let key1Val = datum[key1].value;\n    let key2Val = datum[key2].value;\n    let label1Val = label1 ? datum[label1].value : key1Val;\n    let label2Val = label2 ? datum[label2].value : key2Val;\n    let value1Val = value1 ? datum[value1].value : false;\n    let value2Val = value2 ? datum[value2].value : false;\n    if (!check.has(key1Val)) {\n      graph.nodes.push({ 'key': key1Val, 'label': label1Val, 'value': value1Val });\n      check.set(key1Val, index);\n      index++;\n    }\n    if (!check.has(key2Val)) {\n      graph.nodes.push({ 'key': key2Val, 'label': label2Val, 'value': value2Val });\n      check.set(key2Val, index);\n      index++;\n    }\n    graph.links.push({ 'source': check.get(key1Val), 'target': check.get(key2Val) });\n  }\n  debug(graph);\n  return graph;\n};\n\n/*\n  Convert sparql-results+json object into a JSON tree of {\"name\": name, \"value\": size, \"children\": []} format like in the flare.json file.\n\n  Suitable for d3.layout.hierarchy() family\n    * cluster:    d3sparql.dendrogram()\n    * pack:       d3sparql.circlepack()\n    * partition:  d3sparql.sunburst()\n    * tree:       d3sparql.roundtree()\n    * treemap:    d3sparql.treemap(), d3sparql.treemapzoom()\n\n  Options:\n    config = {\n      \"root\":   \"root_name\",    // SPARQL letiable name for root node (optional; default is the 1st letiable)\n      \"parent\": \"parent_name\",  // SPARQL letiable name for parent node (optional; default is the 2nd letiable)\n      \"child\":  \"child_name\",   // SPARQL letiable name for child node (ptional; default is the 3rd letiable)\n      \"value\":  \"value_name\"    // SPARQL letiable name for numerical value of the child node (optional; default is the 4th letiable or \"value\")\n    }\n\n  Synopsis:\n    d3sparql.sparql(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.roundtree(json, config)\n      d3sparql.dendrogram(json, config)\n      d3sparql.sunburst(json, config)\n      d3sparql.treemap(json, config)\n      d3sparql.treemapzoom(json, config)\n    }\n*/\nd3sparql.tree = function (json, config = {}) {\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'root': config.root || head[0],\n    'parent': config.parent || head[1],\n    'child': config.child || head[2],\n    'value': config.value || head[3] || 'value',\n  };\n\n  let pair = new Map();\n  let size = new Map();\n  let root = data[0][opts.root].value;\n  let parent = true;\n  let child = parent;\n  for (let i = 0; i < data.length; i++) {\n    const datum = data[i];\n    parent = datum[opts.parent].value;\n    child = datum[opts.child].value;\n    if (parent !== child) {\n      /** @type {Array} */\n      let children;\n      if (pair.has(parent)) {\n        children = pair.get(parent);\n        children.push(child);\n      } else {\n        children = [child];\n      }\n      pair.set(parent, children);\n      if (datum[opts.value]) {\n        size.set(child, datum[opts.value].value);\n      }\n    }\n  }\n\n  function traverse(node) {\n    let list = pair.get(node);\n    if (list) {\n      let children = list.map(function (d) {\n        return traverse(d);\n      });\n      // sum of values of children\n      let subtotal = d3.sum(children, function (d) {\n        return d.value;\n      });\n      // add a value of parent if exists\n      let total = d3.sum([subtotal, size.get(node)]);\n      return { 'name': node, 'children': children, 'value': total };\n    } else {\n      return { 'name': node, 'value': size.get(node) || 1 };\n    }\n  }\n\n  let tree = traverse(root);\n\n  debug(tree);\n  return tree;\n};\n\n/*\n  Rendering sparql-results+json object containing multiple rows into a HTML table\n\n  Options:\n    config = {\n      \"selector\": \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.htmltable(json, config)\n    }\n\n  CSS:\n    <style>\n    table {\n      margin: 10px;\n    }\n    th {\n      background: #eeeeee;\n    }\n    th:first-letter {\n       text-transform: capitalize;\n    }\n    </style>\n*/\nd3sparql.htmltable = function (json, config = {}) {\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  const columns = config.columns || head;\n  const headers = config.headers || columns;\n  const selector = config.selector || null;\n  const limit =  config.limit !== undefined ? config.limit : data.length;\n  const offset = config.offset !== undefined ? config.offset : 0;\n\n  data = data.slice(offset, offset + limit);\n\n  let table = d3sparql.select(selector, 'htmltable').append('table').attr('class', 'table table-bordered');\n  debug(\"Table\");\n  debug(table);\n  let thead = table.append('thead');\n  let tbody = table.append('tbody');\n  thead.append('tr')\n    .selectAll('th')\n    .data(headers)\n    .enter()\n    .append('th')\n    .text((col) => col);\n  let rows = tbody.selectAll('tr')\n    .data(data)\n    .enter()\n    .append('tr');\n  let cells = rows.selectAll('td')\n    .data((row) => columns.map((col) => row[col] ? row[col].value : ''))\n    .enter()\n    .append('td')\n    .text((val) => val);\n\n  debug(\"Table cells\");\n  debug(cells);\n\n  // default CSS\n  table.style({\n    'margin': '10px'\n  });\n  table.selectAll('th').style({\n    'background': '#eeeeee',\n    'text-transform': 'capitalize',\n  });\n};\n\n/*\n  Rendering sparql-results+json object containing one row into a HTML table\n\n  Options:\n    config = {\n      \"selector\": \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.htmlhash(json, config)\n    }\n\n  CSS:\n    <style>\n    table {\n      margin: 10px;\n    }\n    th {\n      background: #eeeeee;\n    }\n    th:first-letter {\n       text-transform: capitalize;\n    }\n    </style>\n*/\nd3sparql.htmlhash = function (json, config) {\n  config = config || {};\n\n  let head = json.head.lets || [];\n  let data = json.results.bindings[0];\n\n  let opts = {\n    'selector': config.selector || null\n  };\n\n  let table = d3sparql.select(opts.selector, 'htmlhash').append('table').attr('class', 'table table-bordered');\n  let tbody = table.append('tbody');\n  let row = tbody.selectAll('tr')\n    .data(function () {\n      return head.map(function (col) {\n        return { 'head': col, 'data': data[col] ? data[col].value : '' };\n      });\n    })\n    .enter()\n    .append('tr');\n  row.append('th')\n    .text(function (d) {\n      return d.head;\n    });\n  row.append('td')\n    .text(function (d) {\n      return d.data;\n    });\n\n  // default CSS\n  table.style({\n    'margin': '10px'\n  });\n  table.selectAll('th').style({\n    'background': '#eeeeee',\n    'text-transform': 'capitalize',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a bar chart\n\n  References:\n    http://bl.ocks.org/mbostock/3885304\n    http://bl.ocks.org/mbostock/4403522\n\n  Options:\n    config = {\n      \"label_x\":  \"Prefecture\",  // label for x-axis (optional; default is same as let_x)\n      \"label_y\":  \"Area\",        // label for y-axis (optional; default is same as let_y)\n      \"let_x\":    \"pref\",        // SPARQL letiable name for x-axis (optional; default is the 1st letiable)\n      \"let_y\":    \"area\",        // SPARQL letiable name for y-axis (optional; default is the 2nd letiable)\n      \"width\":    850,           // canvas width (optional)\n      \"height\":   300,           // canvas height (optional)\n      \"margin\":   40,            // canvas margin (optional)\n      \"selector\": \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.barchart(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .bar {\n      fill: steelblue;\n    }\n    .bar:hover {\n      fill: brown;\n    }\n    .axis {\n      font: 10px sans-serif;\n    }\n    .axis path,\n    .axis line {\n      fill: none;\n      stroke: #000000;\n      shape-rendering: crispEdges;\n    }\n    .x.axis path {\n      display: none;\n    }\n    </style>\n*/\nd3sparql.barchart = function (json, config) {\n  config = config || {};\n\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'label_x': config.label_x || head[0],\n    'label_y': config.label_y || head[1],\n    'let_x': config.let_x || head[0],\n    'let_y': config.let_y || head[1],\n    'width': config.width || 750,\n    'height': config.height || 300,\n    'margin': config.margin || 80,  // TODO: to make use of {top: 10, right: 10, bottom: 80, left: 80}\n    'selector': config.selector || null\n  };\n\n  let scale_x = d3.scale.ordinal().rangeRoundBands([0, opts.width - opts.margin], 0.1);\n  let scale_y = d3.scale.linear().range([opts.height - opts.margin, 0]);\n  let axis_x = d3.svg.axis().scale(scale_x).orient('bottom');\n  let axis_y = d3.svg.axis().scale(scale_y).orient('left');  // .ticks(10, \"%\")\n  scale_x.domain(data.map(function (d) {\n    return d[opts.let_x].value;\n  }));\n  scale_y.domain(d3.extent(data, function (d) {\n    return parseInt(d[opts.let_y].value);\n  }));\n\n  let svg = d3sparql.select(opts.selector, 'barchart').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height);\n//    .append(\"g\")\n//    .attr(\"transform\", \"translate(\" + opts.margin + \",\" + 0 + \")\")\n\n  let ax = svg.append('g')\n    .attr('class', 'axis x')\n    .attr('transform', 'translate(' + opts.margin + ',' + (opts.height - opts.margin) + ')')\n    .call(axis_x);\n  let ay = svg.append('g')\n    .attr('class', 'axis y')\n    .attr('transform', 'translate(' + opts.margin + ',0)')\n    .call(axis_y);\n  let bar = svg.selectAll('.bar')\n    .data(data)\n    .enter()\n    .append('rect')\n    .attr('transform', 'translate(' + opts.margin + ',' + 0 + ')')\n    .attr('class', 'bar')\n    .attr('x', function (d) {\n      return scale_x(d[opts.let_x].value);\n    })\n    .attr('width', scale_x.rangeBand())\n    .attr('y', function (d) {\n      return scale_y(d[opts.let_y].value);\n    })\n    .attr('height', function (d) {\n      return opts.height - scale_y(parseInt(d[opts.let_y].value)) - opts.margin;\n    });\n  /*\n      .call(function(e) {\n        e.each(function(d) {\n          console.log(parseInt(d[opts.let_y].value))\n        })\n      })\n  */\n  ax.selectAll('text')\n    .attr('dy', '.35em')\n    .attr('x', 10)\n    .attr('y', 0)\n    .attr('transform', 'rotate(90)')\n    .style('text-anchor', 'start');\n  ax.append('text')\n    .attr('class', 'label')\n    .text(opts.label_x)\n    .style('text-anchor', 'middle')\n    .attr('transform', 'translate(' + ((opts.width - opts.margin) / 2) + ',' + (opts.margin - 5) + ')');\n  ay.append('text')\n    .attr('class', 'label')\n    .text(opts.label_y)\n    .style('text-anchor', 'middle')\n    .attr('transform', 'rotate(-90)')\n    .attr('x', 0 - (opts.height / 2))\n    .attr('y', 0 - (opts.margin - 20));\n\n  // default CSS/SVG\n  bar.attr({\n    'fill': 'steelblue',\n  });\n  svg.selectAll('.axis').attr({\n    'stroke': 'black',\n    'fill': 'none',\n    'shape-rendering': 'crispEdges',\n  });\n  svg.selectAll('text').attr({\n    'stroke': 'none',\n    'fill': 'black',\n    'font-size': '8pt',\n    'font-family': 'sans-serif',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a pie chart\n\n  References:\n    http://bl.ocks.org/mbostock/3887235 Pie chart\n    http://bl.ocks.org/mbostock/3887193 Donut chart\n\n  Options:\n    config = {\n      \"label\":    \"pref\",    // SPARQL letiable name for slice label (optional; default is the 1st letiable)\n      \"size\":     \"area\",    // SPARQL letiable name for slice value (optional; default is the 2nd letiable)\n      \"width\":    700,       // canvas width (optional)\n      \"height\":   600,       // canvas height (optional)\n      \"margin\":   10,        // canvas margin (optional)\n      \"hole\":     50,        // radius size of a center hole (optional; 0 for pie, r > 0 for doughnut)\n      \"selector\": \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.piechart(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .label {\n      font: 10px sans-serif;\n    }\n    .arc path {\n      stroke: #ffffff;\n    }\n    </style>\n*/\nd3sparql.piechart = function (json, config = {}) {\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'label': config.label || head[0],\n    'size': config.size || head[1],\n    'width': config.width || 700,\n    'height': config.height || 700,\n    'margin': config.margin || 10,\n    'hole': config.hole || 100,\n    'selector': config.selector || null\n  };\n\n  let radius = Math.min(opts.width, opts.height) / 2 - opts.margin;\n  let hole = Math.max(Math.min(radius - 50, opts.hole), 0);\n  let color = d3.scale.category20();\n\n  let arc = d3.svg.arc()\n    .outerRadius(radius)\n    .innerRadius(hole);\n\n  let pie = d3.layout.pie()\n    //.sort(null)\n    .value(function (d) {\n      return d[opts.size].value;\n    });\n\n  let svg = d3sparql\n    .select(opts.selector, 'piechart')\n    .append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height)\n    .append('g')\n    .attr('transform', 'translate(' + opts.width / 2 + ',' + opts.height / 2 + ')');\n\n  let g = svg.selectAll('.arc')\n    .data(pie(data))\n    .enter()\n    .append('g')\n    .attr('class', 'arc');\n  let slice = g.append('path')\n    .attr('d', arc)\n    .attr('fill', function (d, i) {\n      return color(i);\n    });\n  let text = g.append('text')\n    .attr('class', 'label')\n    .attr('transform', function (d) {\n      return 'translate(' + arc.centroid(d) + ')';\n    })\n    .attr('dy', '.35em')\n    .attr('text-anchor', 'middle')\n    .text(function (d) {\n      return d.data[opts.label].value;\n    });\n\n  // default CSS/SVG\n  slice.attr({\n    'stroke': '#ffffff',\n  });\n  // TODO: not working?\n  svg.selectAll('text').attr({\n    'stroke': 'none',\n    'fill': 'black',\n    'font-size': '20px',\n    'font-family': 'sans-serif',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a scatter plot\n\n  References:\n    http://bl.ocks.org/mbostock/3244058\n\n  Options:\n    config = {\n      \"label_x\":  \"Size\",    // label for x-axis (optional; default is same as let_x)\n      \"label_y\":  \"Count\",   // label for y-axis (optional; default is same as let_y)\n      \"let_x\":    \"size\",    // SPARQL letiable name for x-axis values (optional; default is the 1st letiable)\n      \"let_y\":    \"count\",   // SPARQL letiable name for y-axis values (optional; default is the 2nd letiable)\n      \"let_r\":    \"volume\",  // SPARQL letiable name for radius (optional; default is the 3rd letiable)\n      \"min_r\":    1,         // minimum radius size (optional; default is 1)\n      \"max_r\":    20,        // maximum radius size (optional; default is 20)\n      \"width\":    850,       // canvas width (optional)\n      \"height\":   300,       // canvas height (optional)\n      \"margin_x\": 80,        // canvas margin x (optional)\n      \"margin_y\": 40,        // canvas margin y (optional)\n      \"selector\": \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.scatterplot(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .label {\n      font-size: 10pt;\n    }\n    .node circle {\n      stroke: black;\n      stroke-width: 1px;\n      fill: pink;\n      opacity: 0.5;\n    }\n    </style>\n*/\nd3sparql.scatterplot = function (json, config = {}) {\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'label_x': config.label_x || head[0] || 'x',\n    'label_y': config.label_y || head[1] || 'y',\n    'label_r': config.label_r || head[2] || 'r',\n    'let_x': config.let_x || head[0],\n    'let_y': config.let_y || head[1],\n    'let_r': config.let_r || head[2] || 5,\n    'min_r': config.min_r || 1,\n    'max_r': config.max_r || 20,\n    'width': config.width || 850,\n    'height': config.height || 300,\n    'margin_x': config.margin_x || 80,\n    'margin_y': config.margin_y || 40,\n    'selector': config.selector || null\n  };\n  let extent_x = d3.extent(data, function (d) {\n    return parseInt(d[opts.let_x].value);\n  });\n  let extent_y = d3.extent(data, function (d) {\n    return parseInt(d[opts.let_y].value);\n  });\n  let extent_r = d3.extent(data, function (d) {\n    return parseInt(d[opts.let_r] ? d[opts.let_r].value : opts.let_r);\n  });\n  let scale_x = d3.scale.linear().range([opts.margin_x, opts.width - opts.margin_x]).domain(extent_x);\n  let scale_y = d3.scale.linear().range([opts.height - opts.margin_y, opts.margin_y]).domain(extent_y);\n  let scale_r = d3.scale.linear().range([opts.min_r, opts.max_r]).domain(extent_r);\n  let axis_x = d3.svg.axis().scale(scale_x);\n  let axis_y = d3.svg.axis().scale(scale_y).orient('left');\n\n  let svg = d3sparql.select(opts.selector, 'scatterplot').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height);\n  let circle = svg.selectAll('circle')\n    .data(data)\n    .enter()\n    .append('circle')\n    .attr('class', 'node')\n    .attr('cx', function (d) {\n      return scale_x(d[opts.let_x].value);\n    })\n    .attr('cy', function (d) {\n      return scale_y(d[opts.let_y].value);\n    })\n    .attr('r', function (d) {\n      return scale_r(d[opts.let_r] ? d[opts.let_r].value : opts.let_r);\n    })\n    .attr('opacity', 0.5)\n    .append('title')\n    .text(function (d) {\n      return d[opts.label_r] ? d[opts.label_r].value : opts.label_r;\n    });\n  let ax = svg.append('g')\n    .attr('class', 'x axis')\n    .attr('transform', 'translate(0,' + (opts.height - opts.margin_y) + ')')\n    .call(axis_x);\n  let ay = svg.append('g')\n    .attr('class', 'y axis')\n    .attr('transform', 'translate(' + opts.margin_x + ',0)')\n    .call(axis_y);\n  ax.append('text')\n    .attr('class', 'label')\n    .text(opts.label_x)\n    .style('text-anchor', 'middle')\n    .attr('transform', 'translate(' + ((opts.width - opts.margin_x) / 2) + ',' + (opts.margin_y - 5) + ')');\n  ay.append('text')\n    .attr('class', 'label')\n    .text(opts.label_y)\n    .style('text-anchor', 'middle')\n    .attr('transform', 'rotate(-90)')\n    .attr('x', 0 - (opts.height / 2))\n    .attr('y', 0 - (opts.margin_x - 20));\n\n  // default CSS/SVG\n  ax.attr({\n    'stroke': 'black',\n    'fill': 'none',\n  });\n  ay.attr({\n    'stroke': 'black',\n    'fill': 'none',\n  });\n  // This doesn't work with .append(\"circle\") with .append(\"title\") for tooltip\n  circle.attr({\n    'stroke': 'gray',\n    'stroke-width': '1px',\n    'fill': 'lightblue',\n    'opacity': 0.5,\n  });\n  //svg.selectAll(\".label\").attr({\n  svg.selectAll('text').attr({\n    'stroke': 'none',\n    'fill': 'black',\n    'font-size': '8pt',\n    'font-family': 'sans-serif',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a force graph\n\n  References:\n    http://bl.ocks.org/mbostock/4062045\n\n  Options:\n    config = {\n      \"radius\":   12,        // static value or a function to calculate radius of nodes (optional)\n      \"charge\":   -250,      // force between nodes (optional; negative: repulsion, positive: attraction)\n      \"distance\": 30,        // target distance between linked nodes (optional)\n      \"width\":    1000,      // canvas width (optional)\n      \"height\":   500,       // canvas height (optional)\n      \"label\":    \"name\",    // SPARQL letiable name for node labels (optional)\n      \"selector\": \"#result\"\n      // options for d3sparql.graph() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.forcegraph(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .link {\n      stroke: #999999;\n    }\n    .node {\n      stroke: black;\n      opacity: 0.5;\n    }\n    circle.node {\n      stroke-width: 1px;\n      fill: lightblue;\n    }\n    text.node {\n      font-family: \"sans-serif\";\n      font-size: 8px;\n    }\n    </style>\n\n  TODO:\n    Try other d3.layout.force options.\n*/\nd3sparql.forcegraph = function (json, config = {}) {\n  let graph = (json.head && json.results) ? d3sparql.graph(json, config) : json;\n\n  let scale = d3.scale.linear()\n    .domain(d3.extent(graph.nodes, (d) => parseFloat(d.value)))\n    .range([1, 20]);\n\n  const radius = config.radius || ((d) => d.value ? scale(d.value) : 1 + d.label.length);\n  const charge = config.charge || -500;\n  const distance = config.distance || 50;\n  const width = config.width || 1000;\n  const height = config.height || 750;\n  const label = config.label || false;\n  const selector = config.selector || null;\n\n  let svg = d3sparql.select(selector, 'forcegraph').append('svg')\n    .attr('width', width)\n    .attr('height', height);\n  let link = svg.selectAll('.link')\n    .data(graph.links)\n    .enter()\n    .append('line')\n    .attr('class', 'link');\n  let node = svg.selectAll('.node')\n    .data(graph.nodes)\n    .enter()\n    .append('g');\n  let circle = node.append('circle')\n    .attr('class', 'node')\n    .attr('r', radius);\n  let text = node.append('text')\n    .text(function (d) {\n      return d[label || 'label'];\n    })\n    .attr('class', 'node');\n  let force = d3.layout.force()\n    .charge(charge)\n    .linkDistance(distance)\n    .size([width, height])\n    .nodes(graph.nodes)\n    .links(graph.links)\n    .start();\n  force.on('tick', function () {\n    link.attr('x1', function (d) {\n        return d.source.x;\n      })\n      .attr('y1', function (d) {\n        return d.source.y;\n      })\n      .attr('x2', function (d) {\n        return d.target.x;\n      })\n      .attr('y2', function (d) {\n        return d.target.y;\n      });\n    text.attr('x', function (d) {\n        return d.x;\n      })\n      .attr('y', function (d) {\n        return d.y;\n      });\n    circle.attr('cx', function (d) {\n        return d.x;\n      })\n      .attr('cy', function (d) {\n        return d.y;\n      });\n  });\n  node.call(force.drag);\n\n  // default CSS/SVG\n  link.attr({\n    'stroke': '#999999',\n  });\n  circle.attr({\n    'stroke': 'black',\n    'stroke-width': '1px',\n    'fill': 'lightblue',\n    'opacity': 1,\n  });\n  text.attr({\n    'font-size': '8px',\n    'font-family': 'sans-serif',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a sanky graph\n\n  References:\n    https://github.com/d3/d3-plugins/tree/master/sankey\n    http://bost.ocks.org/mike/sankey/\n\n  Options:\n    config = {\n      \"width\":    1000,      // canvas width (optional)\n      \"height\":   900,       // canvas height (optional)\n      \"margin\":   50,        // canvas margin (optional)\n      \"selector\": \"#result\"\n      // options for d3sparql.graph() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.sankey(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .node rect {\n      cursor: move;\n      fill-opacity: .9;\n      shape-rendering: crispEdges;\n    }\n    .node text {\n      pointer-events: none;\n      text-shadow: 0 1px 0 #ffffff;\n    }\n    .link {\n      fill: none;\n      stroke: #000000;\n      stroke-opacity: .2;\n    }\n    .link:hover {\n      stroke-opacity: .5;\n    }\n    </style>\n\n  Dependencies:\n    * sankey.js\n      * Download from https://github.com/d3/d3-plugins/tree/master/sankey\n      * Put <script src=\"sankey.js\"></script> in the HTML <head> section\n*/\nd3sparql.sankey = function (json, config) {\n  config = config || {};\n\n  let graph = (json.head && json.results) ? d3sparql.graph(json, config) : json;\n\n  let opts = {\n    'width': config.width || 750,\n    'height': config.height || 1200,\n    'margin': config.margin || 10,\n    'selector': config.selector || null\n  };\n\n  let nodes = graph.nodes;\n  let links = graph.links;\n  for (let i = 0; i < links.length; i++) {\n    links[i].value = 2;  // TODO: fix to use values on links\n  }\n  let sankey = d3.sankey()\n    .size([opts.width, opts.height])\n    .nodeWidth(15)\n    .nodePadding(10)\n    .nodes(nodes)\n    .links(links)\n    .layout(32);\n  let path = sankey.link();\n  let color = d3.scale.category20();\n  let svg = d3sparql.select(opts.selector, 'sankey').append('svg')\n    .attr('width', opts.width + opts.margin * 2)\n    .attr('height', opts.height + opts.margin * 2)\n    .append('g')\n    .attr('transform', 'translate(' + opts.margin + ',' + opts.margin + ')');\n  let link = svg.selectAll('.link')\n    .data(links)\n    .enter()\n    .append('path')\n    .attr('class', 'link')\n    .attr('d', path)\n    .attr('stroke-width', function (d) {\n      return Math.max(1, d.dy);\n    })\n    .sort(function (a, b) {\n      return b.dy - a.dy;\n    });\n  let node = svg.selectAll('.node')\n    .data(nodes)\n    .enter()\n    .append('g')\n    .attr('class', 'node')\n    .attr('transform', function (d) {\n      return 'translate(' + d.x + ',' + d.y + ')';\n    })\n    .call(d3.behavior.drag()\n      .origin(function (d) {\n        return d;\n      })\n      .on('dragstart', function () {\n        this.parentNode.appendChild(this);\n      })\n      .on('drag', dragmove)\n    );\n  node.append('rect')\n    .attr('width', function (d) {\n      return d.dx;\n    })\n    .attr('height', function (d) {\n      return d.dy;\n    })\n    .attr('fill', function (d) {\n      return color(d.label);\n    })\n    .attr('opacity', 0.5);\n  node.append('text')\n    .attr('x', -6)\n    .attr('y', function (d) {\n      return d.dy / 2;\n    })\n    .attr('dy', '.35em')\n    .attr('text-anchor', 'end')\n    .attr('transform', null)\n    .text(function (d) {\n      return d.label;\n    })\n    .filter(function (d) {\n      return d.x < opts.width / 2;\n    })\n    .attr('x', 6 + sankey.nodeWidth())\n    .attr('text-anchor', 'start');\n\n  // default CSS/SVG\n  link.attr({\n    'fill': 'none',\n    'stroke': 'grey',\n    'opacity': 0.5,\n  });\n\n  function dragmove(d) {\n    d3.select(this).attr('transform', 'translate(' + d.x + ',' + (d.y = Math.max(0, Math.min(opts.height - d.dy, d3.event.y))) + ')');\n    sankey.relayout();\n    link.attr('d', path);\n  }\n};\n\n\n/*\n  Rendering sparql-results+json object into a round tree\n\n  References:\n    http://bl.ocks.org/4063550  Reingold-Tilford Tree\n\n  Options:\n    config = {\n      \"diameter\": 800,       // canvas diameter (optional)\n      \"angle\":    360,       // arc angle (optional; less than 360 for wedge)\n      \"depth\":    200,       // arc depth (optional; less than diameter/2 - label length to fit)\n      \"radius\":   5,         // node radius (optional)\n      \"selector\": \"#result\"\n      // options for d3sparql.tree() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.roundtree(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .link {\n      fill: none;\n      stroke: #cccccc;\n      stroke-width: 1.5px;\n    }\n    .node circle {\n      fill: #ffffff;\n      stroke: darkgreen;\n      stroke-width: 1.5px;\n      opacity: 1;\n    }\n    .node text {\n      font-size: 10px;\n      font-family: sans-serif;\n    }\n    </style>\n*/\nd3sparql.roundtree = function (json, config) {\n  config = config || {};\n\n  let tree = (json.head && json.results) ? d3sparql.tree(json, config) : json;\n\n  let opts = {\n    'diameter': config.diameter || 800,\n    'angle': config.angle || 360,\n    'depth': config.depth || 200,\n    'radius': config.radius || 5,\n    'selector': config.selector || null\n  };\n\n  let tree_layout = d3.layout.tree()\n    .size([opts.angle, opts.depth])\n    .separation(function (a, b) {\n      return (a.parent === b.parent ? 1 : 2) / a.depth;\n    });\n  let nodes = tree_layout.nodes(tree);\n  let links = tree_layout.links(nodes);\n  let diagonal = d3.svg.diagonal.radial()\n    .projection(function (d) {\n      return [d.y, d.x / 180 * Math.PI];\n    });\n  let svg = d3sparql.select(opts.selector, 'roundtree').append('svg')\n    .attr('width', opts.diameter)\n    .attr('height', opts.diameter)\n    .append('g')\n    .attr('transform', 'translate(' + opts.diameter / 2 + ',' + opts.diameter / 2 + ')');\n  let link = svg.selectAll('.link')\n    .data(links)\n    .enter()\n    .append('path')\n    .attr('class', 'link')\n    .attr('d', diagonal);\n  let node = svg.selectAll('.node')\n    .data(nodes)\n    .enter()\n    .append('g')\n    .attr('class', 'node')\n    .attr('transform', function (d) {\n      return 'rotate(' + (d.x - 90) + ') translate(' + d.y + ')';\n    });\n  let circle = node.append('circle')\n    .attr('r', opts.radius);\n  let text = node.append('text')\n    .attr('dy', '.35em')\n    .attr('text-anchor', function (d) {\n      return d.x < 180 ? 'start' : 'end';\n    })\n    .attr('transform', function (d) {\n      return d.x < 180 ? 'translate(8)' : 'rotate(180) translate(-8)';\n    })\n    .text(function (d) {\n      return d.name;\n    });\n\n  // default CSS/SVG\n  link.attr({\n    'fill': 'none',\n    'stroke': '#cccccc',\n    'stroke-width': '1.5px',\n  });\n  circle.attr({\n    'fill': '#ffffff',\n    'stroke': 'steelblue',\n    'stroke-width': '1.5px',\n    'opacity': 1,\n  });\n  text.attr({\n    'font-size': '10px',\n    'font-family': 'sans-serif',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a dendrogram\n\n  References:\n    http://bl.ocks.org/4063570  Cluster Dendrogram\n\n  Options:\n    config = {\n      \"width\":    900,       // canvas width (optional)\n      \"height\":   4500,      // canvas height (optional)\n      \"margin\":   300,       // width margin for labels (optional)\n      \"radius\":   5,         // radius of node circles (optional)\n      \"selector\": \"#result\"\n      // options for d3sparql.tree() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.dendrogram(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .link {\n      fill: none;\n      stroke: #cccccc;\n      stroke-width: 1.5px;\n    }\n    .node circle {\n      fill: #ffffff;\n      stroke: steelblue;\n      stroke-width: 1.5px;\n      opacity: 1;\n    }\n    .node text {\n      font-size: 10px;\n      font-family: sans-serif;\n    }\n    </style>\n*/\nd3sparql.dendrogram = function (json, config) {\n  config = config || {};\n\n  let tree = (json.head && json.results) ? d3sparql.tree(json, config) : json;\n\n  let opts = {\n    'width': config.width || 800,\n    'height': config.height || 2000,\n    'margin': config.margin || 350,\n    'radius': config.radius || 5,\n    'selector': config.selector || null\n  };\n\n  let cluster = d3.layout.cluster()\n    .size([opts.height, opts.width - opts.margin]);\n  let diagonal = d3.svg.diagonal()\n    .projection(function (d) {\n      return [d.y, d.x];\n    });\n  let svg = d3sparql.select(opts.selector, 'dendrogram').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height)\n    .append('g')\n    .attr('transform', 'translate(40,0)');\n  let nodes = cluster.nodes(tree);\n  let links = cluster.links(nodes);\n  let link = svg.selectAll('.link')\n    .data(links)\n    .enter().append('path')\n    .attr('class', 'link')\n    .attr('d', diagonal);\n  let node = svg.selectAll('.node')\n    .data(nodes)\n    .enter().append('g')\n    .attr('class', 'node')\n    .attr('transform', function (d) {\n      return 'translate(' + d.y + ',' + d.x + ')';\n    });\n  let circle = node.append('circle')\n    .attr('r', opts.radius);\n  let text = node.append('text')\n    .attr('dx', function (d) {\n      return (d.parent && d.children) ? -8 : 8;\n    })\n    .attr('dy', 5)\n    .style('text-anchor', function (d) {\n      return (d.parent && d.children) ? 'end' : 'start';\n    })\n    .text(function (d) {\n      return d.name;\n    });\n\n  // default CSS/SVG\n  link.attr({\n    'fill': 'none',\n    'stroke': '#cccccc',\n    'stroke-width': '1.5px',\n  });\n  circle.attr({\n    'fill': '#ffffff',\n    'stroke': 'steelblue',\n    'stroke-width': '1.5px',\n    'opacity': 1,\n  });\n  text.attr({\n    'font-size': '10px',\n    'font-family': 'sans-serif',\n  });\n};\n\n/*\n  Rendering sparql-results+json object into a sunburst\n\n  References:\n    http://bl.ocks.org/4348373  Zoomable Sunburst\n    http://www.jasondavies.com/coffee-wheel/  Coffee Flavour Wheel\n\n  Options:\n    config = {\n      \"width\":    1000,      // canvas width (optional)\n      \"height\":   900,       // canvas height (optional)\n      \"margin\":   150,       // margin for labels (optional)\n      \"selector\": \"#result\"\n      // options for d3sparql.tree() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.sunburst(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .node text {\n      font-size: 10px;\n      font-family: sans-serif;\n    }\n    .arc {\n      stroke: #ffffff;\n      fill-rule: evenodd;\n    }\n    </style>\n*/\nd3sparql.sunburst = function (json, config = {}) {\n  let tree = (json.head && json.results) ? d3sparql.tree(json, config) : json;\n\n  let opts = {\n    'width': config.width || 1000,\n    'height': config.height || 900,\n    'margin': config.margin || 150,\n    'selector': config.selector || null\n  };\n\n  let radius = Math.min(opts.width, opts.height) / 2 - opts.margin;\n  let x = d3.scale.linear().range([0, 2 * Math.PI]);\n  let y = d3.scale.sqrt().range([0, radius]);\n  let color = d3.scale.category20();\n  let svg = d3sparql.select(opts.selector, 'sunburst').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height)\n    .append('g')\n    .attr('transform', 'translate(' + opts.width / 2 + ',' + opts.height / 2 + ')');\n  let arc = d3.svg.arc()\n    .startAngle(function (d) {\n      return Math.max(0, Math.min(2 * Math.PI, x(d.x)));\n    })\n    .endAngle(function (d) {\n      return Math.max(0, Math.min(2 * Math.PI, x(d.x + d.dx)));\n    })\n    .innerRadius(function (d) {\n      return Math.max(0, y(d.y));\n    })\n    .outerRadius(function (d) {\n      return Math.max(0, y(d.y + d.dy));\n    });\n  let partition = d3.layout.partition()\n    .value(function (d) {\n      return d.value;\n    });\n  let nodes = partition.nodes(tree);\n  let path = svg.selectAll('path')\n    .data(nodes)\n    .enter()\n    .append('path')\n    .attr('d', arc)\n    .attr('class', 'arc')\n    .style('fill', function (d) {\n      return color((d.children ? d : d.parent).name);\n    })\n    .on('click', click);\n  let text = svg.selectAll('text')\n    .data(nodes)\n    .enter()\n    .append('text')\n    .attr('transform', function (d) {\n      let rotate = x(d.x + d.dx / 2) * 180 / Math.PI - 90;\n      return 'rotate(' + rotate + ') translate(' + y(d.y) + ')';\n    })\n    .attr('dx', '.5em')\n    .attr('dy', '.35em')\n    .text(function (d) {\n      return d.name;\n    })\n    .on('click', click);\n\n  // default CSS/SVG\n  path.attr({\n    'stroke': '#ffffff',\n    'fill-rule': 'evenodd',\n  });\n  text.attr({\n    'font-size': '10px',\n    'font-family': 'sans-serif',\n  });\n\n  function click(d) {\n    path.transition()\n      .duration(750)\n      .attrTween('d', arcTween(d));\n    text.style('visibility', function (e) {\n        // required for showing labels just before the transition when zooming back to the upper level\n        return isParentOf(d, e) ? null : d3.select(this).style('visibility');\n      })\n      .transition()\n      .duration(750)\n      .attrTween('transform', function (d) {\n        return function () {\n          let rotate = x(d.x + d.dx / 2) * 180 / Math.PI - 90;\n          return 'rotate(' + rotate + ') translate(' + y(d.y) + ')';\n        };\n      })\n      .each('end', function (e) {\n        // required for hiding labels just after the transition when zooming down to the lower level\n        d3.select(this).style('visibility', isParentOf(d, e) ? null : 'hidden');\n      });\n  }\n\n  function maxDepth(d) {\n    return d.children ? Math.max.apply(Math, d.children.map(maxDepth)) : d.y + d.dy;\n  }\n\n  function arcTween(d) {\n    let xd = d3.interpolate(x.domain(), [d.x, d.x + d.dx]),\n      yd = d3.interpolate(y.domain(), [d.y, maxDepth(d)]),\n      yr = d3.interpolate(y.range(), [d.y ? 20 : 0, radius]);\n    return function (d) {\n      return function (t) {\n        x.domain(xd(t));\n        y.domain(yd(t)).range(yr(t));\n        return arc(d);\n      };\n    };\n  }\n\n  function isParentOf(p, c) {\n    if (p === c) return true;\n    if (p.children) {\n      return p.children.some(function (d) {\n        return isParentOf(d, c);\n      });\n    }\n    return false;\n  }\n};\n\n/*\n  Rendering sparql-results+json object into a circle pack\n\n  References:\n    http://mbostock.github.com/d3/talk/20111116/pack-hierarchy.html  Circle Packing\n\n  Options:\n    config = {\n      \"width\":    800,       // canvas width (optional)\n      \"height\":   800,       // canvas height (optional)\n      \"diameter\": 700,       // diamieter of the outer circle (optional)\n      \"selector\": \"#result\"\n      // options for d3sparql.tree() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.circlepack(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    text {\n      font-size: 11px;\n      pointer-events: none;\n    }\n    text.parent {\n      fill: #1f77b4;\n    }\n    circle {\n      fill: #cccccc;\n      stroke: #999999;\n      pointer-events: all;\n    }\n    circle.parent {\n      fill: #1f77b4;\n      fill-opacity: .1;\n      stroke: steelblue;\n    }\n    circle.parent:hover {\n      stroke: #ff7f0e;\n      stroke-width: .5px;\n    }\n    circle.child {\n      pointer-events: none;\n    }\n    </style>\n\n  TODO:\n    Fix rotation angle for each text to avoid string collision\n*/\nd3sparql.circlepack = function (json, config) {\n  config = config || {};\n\n  let tree = (json.head && json.results) ? d3sparql.tree(json, config) : json;\n\n  let opts = {\n    'width': config.width || 800,\n    'height': config.height || 800,\n    'diameter': config.diameter || 700,\n    'selector': config.selector || null\n  };\n\n  let w = opts.width,\n    h = opts.height,\n    r = opts.diameter,\n    x = d3.scale.linear().range([0, r]),\n    y = d3.scale.linear().range([0, r]);\n\n  let pack = d3.layout.pack()\n    .size([r, r])\n    .value(function (d) {\n      return d.value;\n    });\n\n  let node = tree;\n  let nodes = pack.nodes(tree);\n\n  let vis = d3sparql.select(opts.selector, 'circlepack').append('svg')\n    .attr('width', w)\n    .attr('height', h)\n    .append('g')\n    .attr('transform', 'translate(' + (w - r) / 2 + ',' + (h - r) / 2 + ')');\n\n  vis.selectAll('circle')\n    .data(nodes)\n    .enter()\n    .append('circle')\n    .attr('class', function (d) {\n      return d.children ? 'parent' : 'child';\n    })\n    .attr('cx', function (d) {\n      return d.x;\n    })\n    .attr('cy', function (d) {\n      return d.y;\n    })\n    .attr('r', function (d) {\n      return d.r;\n    })\n    /*\n        // CSS: circle { ... }\n        .attr(\"fill\", function(d) { return d.children ? \"#1f77b4\" : \"#cccccc\" })\n        .attr(\"fill-opacity\", function(d) { return d.children ? \".1\" : \"1\" })\n        .attr(\"stroke\", function(d) { return d.children ? \"steelblue\" : \"#999999\" })\n        .attr(\"pointer-events\", function(d) { return d.children ? \"all\" : \"none\" })\n        .on(\"mouseover\", function() { d3.select(this).attr(\"stroke\", \"#ff7f0e\").attr(\"stroke-width\", \".5px\") })\n        .on(\"mouseout\", function() { d3.select(this).attr(\"stroke\", \"steelblue\").attr(\"stroke-width\", \".5px\") })\n    */\n    .on('click', function (d) {\n      return zoom(node === d ? tree : d);\n    });\n\n  vis.selectAll('text')\n    .data(nodes)\n    .enter()\n    .append('text')\n    .attr('class', function (d) {\n      return d.children ? 'parent' : 'child';\n    })\n    .attr('x', function (d) {\n      return d.x;\n    })\n    .attr('y', function (d) {\n      return d.y;\n    })\n    //    .attr(\"dy\", \".35em\")\n    .style('opacity', function (d) {\n      return d.r > 20 ? 1 : 0;\n    })\n    .text(function (d) {\n      return d.name;\n    })\n    // rotate to avoid string collision\n    //.attr(\"text-anchor\", \"middle\")\n    .attr('text-anchor', 'start')\n    .transition()\n    .duration(1000)\n    .attr('transform', function (d) {\n      return 'rotate(-30, ' + d.x + ', ' + d.y + ')';\n    });\n\n  d3.select(window).on('click', function () {\n    zoom(tree);\n  });\n\n  function zoom(d, i) {\n    let k = r / d.r / 2;\n    x.domain([d.x - d.r, d.x + d.r]);\n    y.domain([d.y - d.r, d.y + d.r]);\n    let t = vis.transition()\n      .duration(d3.event.altKey ? 2000 : 500);\n    t.selectAll('circle')\n      .attr('cx', function (d) {\n        return x(d.x);\n      })\n      .attr('cy', function (d) {\n        return y(d.y);\n      })\n      .attr('r', function (d) {\n        return k * d.r;\n      });\n    t.selectAll('text')\n      .attr('x', function (d) {\n        return x(d.x);\n      })\n      .attr('y', function (d) {\n        return y(d.y);\n      })\n      .style('opacity', function (d) {\n        return k * d.r > 20 ? 1 : 0;\n      });\n    d3.event.stopPropagation();\n  }\n};\n\n/*\n  Rendering sparql-results+json object into a treemap\n\n  References:\n    http://bl.ocks.org/4063582  Treemap\n\n  Options:\n    config = {\n      \"width\":    800,       // canvas width (optional)\n      \"height\":   500,       // canvas height (optional)\n      \"margin\":   {\"top\": 10, \"right\": 10, \"bottom\": 10, \"left\": 10},\n      \"selector\": \"#result\"\n      // options for d3sparql.tree() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.treemap(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    .node {\n      border: solid 1px white;\n      font: 10px sans-serif;\n      line-height: 12px;\n      overflow: hidden;\n      position: absolute;\n      text-indent: 2px;\n    }\n    </style>\n*/\nd3sparql.treemap = function (json, config = {}) {\n  let tree = (json.head && json.results) ? d3sparql.tree(json, config) : json;\n\n  let opts = {\n    'width': config.width || 800,\n    'height': config.height || 500,\n    'count': config.count || false,\n    'color': config.color || d3.scale.category20c(),\n    'margin': config.margin || { top: 0, right: 0, bottom: 0, left: 0 },\n    'selector': config.selector || null\n  };\n\n  let width = opts.width - opts.margin.left - opts.margin.right;\n  let height = opts.height - opts.margin.top - opts.margin.bottom;\n  let color = opts.color;\n\n  function count(d) {\n    return 1;\n  }\n\n  function size(d) {\n    return d.value;\n  }\n\n  let treemap = d3.layout.treemap()\n    .size([width, height])\n    .sticky(true)\n    .value(opts.count ? count : size);\n\n  let div = d3sparql.select(opts.selector, 'treemap')\n    .style('position', 'relative')\n    .style('width', opts.width + 'px')\n    .style('height', opts.height + 'px')\n    .style('left', opts.margin.left + 'px')\n    .style('top', opts.margin.top + 'px');\n\n  let node = div.datum(tree).selectAll('.node')\n    .data(treemap.nodes)\n    .enter()\n    .append('div')\n    .attr('class', 'node')\n    .call(position)\n    .style('background', function (d) {\n      return d.children ? color(d.name) : null;\n    })\n    .text(function (d) {\n      return d.children ? null : d.name;\n    });\n\n  // default CSS/SVG\n  node.style({\n    'border-style': 'solid',\n    'border-width': '1px',\n    'border-color': 'white',\n    'font-size': '10px',\n    'font-family': 'sans-serif',\n    'line-height': '12px',\n    'overflow': 'hidden',\n    'position': 'absolute',\n    'text-indent': '2px',\n  });\n\n  function position() {\n    this.style('left', function (d) {\n        return d.x + 'px';\n      })\n      .style('top', function (d) {\n        return d.y + 'px';\n      })\n      .style('width', function (d) {\n        return Math.max(0, d.dx - 1) + 'px';\n      })\n      .style('height', function (d) {\n        return Math.max(0, d.dy - 1) + 'px';\n      });\n  }\n};\n\n/*\n  Rendering sparql-results+json object into a zoomable treemap\n\n  References:\n    http://bost.ocks.org/mike/treemap/  Zoomable Treemaps\n    http://bl.ocks.org/zanarmstrong/76d263bd36f312cb0f9f\n\n  Options:\n    config = {\n      \"width\":    800,       // canvas width (optional)\n      \"height\":   500,       // canvas height (optional)\n      \"margin\":   {\"top\": 10, \"right\": 10, \"bottom\": 10, \"left\": 10},\n      \"selector\": \"#result\"\n      // options for d3sparql.tree() can be added here ...\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      let config = { ... }\n      d3sparql.treemapzoom(json, config)\n    }\n\n  CSS/SVG:\n    <style>\n    rect {\n      cursor: pointer;\n    }\n    .grandparent:hover rect {\n      opacity: 0.8;\n    }\n    .children:hover rect.child {\n      opacity: 0.2;\n    }\n    </style>\n*/\nd3sparql.treemapzoom = function (json, config) {\n  config = config || {};\n\n  let tree = (json.head && json.results) ? d3sparql.tree(json, config) : json;\n\n  let opts = {\n    'width': config.width || 800,\n    'height': config.height || 500,\n    'margin': config.margin || { top: 25, right: 0, bottom: 0, left: 0 },\n    'color': config.color || d3.scale.category20(),\n    'format': config.format || d3.format(',d'),\n    'selector': config.selector || null\n  };\n\n  let width = opts.width - opts.margin.left - opts.margin.right;\n  let height = opts.height - opts.margin.top - opts.margin.bottom;\n  let color = opts.color;\n  let format = opts.format;\n  let transitioning;\n\n  let x = d3.scale.linear().domain([0, width]).range([0, width]);\n  let y = d3.scale.linear().domain([0, height]).range([0, height]);\n\n  let treemap = d3.layout.treemap()\n    .children(function (d, depth) {\n      return depth ? null : d.children;\n    })\n    .sort(function (a, b) {\n      return a.value - b.value;\n    })\n    .ratio(height / width * 0.5 * (1 + Math.sqrt(5)))\n    .round(false);\n\n  let svg = d3sparql.select(opts.selector, 'treemapzoom').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height)\n    .style('margin-left', -opts.margin.left + 'px')\n    .style('margin.right', -opts.margin.right + 'px')\n    .append('g')\n    .attr('transform', 'translate(' + opts.margin.left + ',' + opts.margin.top + ')')\n    .style('shape-rendering', 'crispEdges');\n\n  let grandparent = svg.append('g')\n    .attr('class', 'grandparent');\n\n  grandparent.append('rect')\n    .attr('y', -opts.margin.top)\n    .attr('width', width)\n    .attr('height', opts.margin.top)\n    .attr('fill', '#666666');\n\n  grandparent.append('text')\n    .attr('x', 6)\n    .attr('y', 6 - opts.margin.top)\n    .attr('dy', '.75em')\n    .attr('stroke', '#ffffff')\n    .attr('fill', '#ffffff');\n\n  initialize(tree);\n  layout(tree);\n  display(tree);\n\n  function initialize(tree) {\n    tree.x = tree.y = 0;\n    tree.dx = width;\n    tree.dy = height;\n    tree.depth = 0;\n  }\n\n  // Compute the treemap layout recursively such that each group of siblings\n  // uses the same size (1×1) rather than the dimensions of the parent cell.\n  // This optimizes the layout for the current zoom state. Note that a wrapper\n  // object is created for the parent node for each group of siblings so that\n  // the parent’s dimensions are not discarded as we recurse. Since each group\n  // of sibling was laid out in 1×1, we must rescale to fit using absolute\n  // coordinates. This lets us use a viewport to zoom.\n  function layout(d) {\n    if (d.children) {\n      treemap.nodes({ children: d.children });\n      d.children.forEach(function (c) {\n        c.x = d.x + c.x * d.dx;\n        c.y = d.y + c.y * d.dy;\n        c.dx *= d.dx;\n        c.dy *= d.dy;\n        c.parent = d;\n        layout(c);\n      });\n    }\n  }\n\n  function display(d) {\n    grandparent\n      .datum(d.parent)\n      .on('click', transition)\n      .select('text')\n      .text(name(d));\n\n    let g1 = svg.insert('g', '.grandparent')\n      .datum(d)\n      .attr('class', 'depth');\n\n    let g = g1.selectAll('g')\n      .data(d.children)\n      .enter()\n      .append('g');\n\n    g.filter(function (d) {\n        return d.children;\n      })\n      .classed('children', true)\n      .on('click', transition);\n\n    g.selectAll('.child')\n      .data(function (d) {\n        return d.children || [d];\n      })\n      .enter()\n      .append('rect')\n      .attr('class', 'child')\n      .call(rect);\n\n    g.append('rect')\n      .attr('class', 'parent')\n      .call(rect)\n      .append('title')\n      .text(function (d) {\n        return format(d.value);\n      });\n\n    g.append('text')\n      .attr('dy', '.75em')\n      .text(function (d) {\n        return d.name;\n      })\n      .call(text);\n\n    function transition(d) {\n      if (transitioning || !d) return;\n      transitioning = true;\n      let g2 = display(d),\n        t1 = g1.transition().duration(750),\n        t2 = g2.transition().duration(750);\n\n      // Update the domain only after entering new elements.\n      x.domain([d.x, d.x + d.dx]);\n      y.domain([d.y, d.y + d.dy]);\n\n      // Enable anti-aliasing during the transition.\n      svg.style('shape-rendering', null);\n\n      // Draw child nodes on top of parent nodes.\n      svg.selectAll('.depth').sort(function (a, b) {\n        return a.depth - b.depth;\n      });\n\n      // Fade-in entering text.\n      g2.selectAll('text').style('fill-opacity', 0);\n\n      // Transition to the new view.\n      t1.selectAll('text').call(text).style('fill-opacity', 0);\n      t2.selectAll('text').call(text).style('fill-opacity', 1);\n      t1.selectAll('rect').call(rect);\n      t2.selectAll('rect').call(rect);\n\n      // Remove the old node when the transition is finished.\n      t1.remove().each('end', function () {\n        svg.style('shape-rendering', 'crispEdges');\n        transitioning = false;\n      });\n    }\n\n    return g;\n  }\n\n  function text(text) {\n    text.attr('x', function (d) {\n        return x(d.x) + 6;\n      })\n      .attr('y', function (d) {\n        return y(d.y) + 6;\n      });\n  }\n\n  function rect(rect) {\n    rect.attr('x', function (d) {\n        return x(d.x);\n      })\n      .attr('y', function (d) {\n        return y(d.y);\n      })\n      .attr('width', function (d) {\n        return x(d.x + d.dx) - x(d.x);\n      })\n      .attr('height', function (d) {\n        return y(d.y + d.dy) - y(d.y);\n      })\n      .attr('fill', function (d) {\n        return color(d.name);\n      });\n    rect.attr({\n      'stroke': '#ffffff',\n      'stroke-width': '1px',\n      'opacity': 0.8,\n    });\n  }\n\n  function name(d) {\n    return d.parent\n      ? name(d.parent) + ' / ' + d.name\n      : d.name;\n  }\n};\n\n/*\n  World Map spotted by coordinations (longitude and latitude)\n\n  Options:\n    config = {\n      \"let_lat\":  \"lat\",     // SPARQL letiable name for latitude (optional; default is the 1st letiable)\n      \"let_lng\":  \"lng\",     // SPARQL letiable name for longitude (optional; default is the 2nd letiable)\n      \"width\":    960,       // canvas width (optional)\n      \"height\":   480,       // canvas height (optional)\n      \"radius\":   5,         // circle radius (optional)\n      \"color\":    \"#FF3333,  // circle color (optional)\n      \"topojson\": \"path/to/world-50m.json\",  // TopoJSON file\n      \"selector\": \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      d3sparql.coordmap(json, config = {})\n    }\n\n  Dependencies:\n    * topojson.js\n      * Download from http://d3js.org/topojson.v1.min.js\n      * Put <script src=\"topojson.js\"></script> in the HTML <head> section\n    * world-50m.json\n      * Download from https://github.com/mbostock/topojson/blob/master/examples/world-50m.json\n*/\nd3sparql.coordmap = function (json, config = {}) {\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'let_lat': config.let_lat || head[0] || 'lat',\n    'let_lng': config.let_lng || head[1] || 'lng',\n    'width': config.width || 960,\n    'height': config.height || 480,\n    'radius': config.radius || 5,\n    'color': config.color || '#FF3333',\n    'topojson': config.topojson || 'world-50m.json',\n    'selector': config.selector || null\n  };\n\n  let projection = d3.geo.equirectangular()\n    .scale(153)\n    .translate([opts.width / 2, opts.height / 2])\n    .precision(.1);\n  let path = d3.geo.path()\n    .projection(projection);\n  let graticule = d3.geo.graticule();\n  let svg = d3sparql.select(opts.selector, 'coordmap').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height);\n\n  svg.append('path')\n    .datum(graticule.outline)\n    .attr('fill', '#a4bac7')\n    .attr('d', path);\n\n  svg.append('path')\n    .datum(graticule)\n    .attr('fill', 'none')\n    .attr('stroke', '#333333')\n    .attr('stroke-width', '.5px')\n    .attr('stroke-opacity', '.5')\n    .attr('d', path);\n\n  d3.json(opts.topojson, function (error, world) {\n    svg.insert('path', '.graticule')\n      .datum(topojson.feature(world, world.objects.land))\n      .attr('fill', '#d7c7ad')\n      .attr('stroke', '#766951')\n      .attr('d', path);\n\n    svg.insert('path', '.graticule')\n      .datum(topojson.mesh(world, world.objects.countries, function (a, b) {\n        return a !== b;\n      }))\n      .attr('class', 'boundary')\n      .attr('fill', 'none')\n      .attr('stroke', '#a5967e')\n      .attr('stroke-width', '.5px')\n      .attr('d', path);\n\n    svg.selectAll('.pin')\n      .data(data)\n      .enter().append('circle', '.pin')\n      .attr('fill', opts.color)\n      .attr('r', opts.radius)\n      .attr('stroke', '#455346')\n      .attr('transform', function (d) {\n        return 'translate(' + projection([\n          d[opts.let_lng].value,\n          d[opts.let_lat].value\n        ]) + ')';\n      });\n  });\n};\n\n/*\n  World Map colored by location names defined in a TopoJSON file\n\n  Options:\n    config = {\n      \"label\":       \"name\",    // SPARQL letiable name for location names (optional; default is the 1st letiable)\n      \"value\":       \"size\",    // SPARQL letiable name for numerical values (optional; default is the 2nd letiable)\n      \"width\":       1000,      // canvas width (optional)\n      \"height\":      1000,      // canvas height (optional)\n      \"color_max\":   \"blue\",    // color for maximum value (optional)\n      \"color_min\":   \"white\",   // color for minimum value (optional)\n      \"color_scale\": \"linear\"   // color scale (optional; \"linear\" or \"log\")\n      \"topojson\":    \"path/to/japan.topojson\",  // TopoJSON file\n      \"mapname\":     \"japan\",   // JSON key name of a map location root (e.g., \"objects\":{\"japan\":{\"type\":\"GeometryCollection\", ...)\n      \"keyname\":     \"name\",    // JSON key name of map locations matched with \"label\" (e.g., \"properties\":{\"name\":\"Tokyo\", ...)\n      \"center_lat\":  34,        // latitude for a map location center (optional; default is 34 for Japan)\n      \"center_lng\":  137,       // longitude for a map location center (optional; default is 137 for Japan)\n      \"scale\":       10000,     // scale of rendering (optional)\n      \"selector\":    \"#result\"\n    }\n\n  Synopsis:\n    d3sparql.query(endpoint, sparql, render)\n\n    function render(json) {\n      d3sparql.namedmap(json, config = {})\n    }\n\n  Dependencies:\n    * topojson.js\n      * Download from http://d3js.org/topojson.v1.min.js\n      * Put <script src=\"topojson.js\"></script> in the HTML <head> section\n    * japan.topojson\n      * Download from https://github.com/sparql-book/sparql-book/blob/master/chapter5/D3/japan.topojson\n*/\nd3sparql.namedmap = function (json, config) {\n  config = config || {};\n\n  let head = json.head.lets || [];\n  let data = json.results.bindings;\n\n  let opts = {\n    'label': config.label || head[0] || 'label',\n    'value': config.value || head[1] || 'value',\n    'width': config.width || 1000,\n    'height': config.height || 1000,\n    'color_max': config.color_max || 'red',\n    'color_min': config.color_min || 'white',\n    'color_scale': config.color_scale || 'log',\n    'topojson': config.topojson || 'japan.topojson',\n    'mapname': config.mapname || 'japan',\n    'keyname': config.keyname || 'name_local',\n    'center_lat': config.center_lat || 34,\n    'center_lng': config.center_lng || 137,\n    'scale': config.scale || 10000,\n    'selector': config.selector || null\n  };\n\n  let size = d3\n    .nest()\n    .key((d) => d[opts.label].value)\n    .rollup((d) => d3.sum(d, (d) => parseInt(d[opts.value].value)))\n    .map(data, d3.map);\n  let extent = d3.extent((d3.map(size).values()));\n\n  debug(size);\n\n  let svg = d3sparql.select(opts.selector, 'namedmap').append('svg')\n    .attr('width', opts.width)\n    .attr('height', opts.height);\n\n  d3.json(opts.topojson, function (topojson_map) {\n    let geo = topojson.object(topojson_map, topojson_map.objects[opts.mapname]).geometries;\n    let projection = d3.geo.mercator()\n      .center([opts.center_lng, opts.center_lat])\n      .translate([opts.width / 2, opts.height / 2])\n      .scale(opts.scale);\n    let path = d3.geo.path().projection(projection);\n    let scale;\n    switch (opts.color_scale) {\n      case 'log':\n        scale = d3.scale.log();\n        break;\n      default:\n        scale = d3.scale.linear();\n        break;\n    }\n    let color = scale.domain(extent).range([opts.color_min, opts.color_max]);\n\n    svg.selectAll('path')\n      .data(geo)\n      .enter()\n      .append('path')\n      .attr('d', path)\n      .attr('stroke', 'black')\n      .attr('stroke-width', 0.5)\n      .style('fill', function (d, i) {\n        // map SPARQL results to colors\n        return color(size[d.properties[opts.keyname]]);\n      });\n\n    svg.selectAll('.place-label')\n      .data(geo)\n      .enter()\n      .append('text')\n      .attr('font-size', '8px')\n      .attr('class', 'place-label')\n      .attr('transform', function (d) {\n        let lat = d.properties.latitude;\n        let lng = d.properties.longitude;\n        return 'translate(' + projection([lng, lat]) + ')';\n      })\n      .attr('dx', '-1.5em')\n      .text( (d) => d.properties[opts.keyname]);\n  });\n};\n\n/**\n * @param {string|EventTarget} [selector] if not given, will use body\n * @param {string} type\n * @returns {d3.Selection<any>}\n */\nd3sparql.select = function (selector, type) {\n  const elem = selector ? d3.select(selector).html('') : d3.select('body');\n  return elem.append('div').attr('class', 'd3sparql ' + type);\n};\n\n/* Helper function only for the d3sparql web site */\nd3sparql.toggle = function () {\n  let button = d3.select('#button');\n  let elem = d3.select('#sparql');\n  if (elem.style('display') === 'none') {\n    elem.style('display', 'inline');\n    button.attr('class', 'icon-chevron-up');\n  } else {\n    elem.style('display', 'none');\n    button.attr('class', 'icon-chevron-down');\n  }\n};\n\n/* for IFRAME embed */\nd3sparql.frameheight = function (height) {\n  d3.select(self.frameElement).style('height', height + 'px');\n};\n"],"names":["d3sparql","version","debug","message","console","JSON","stringify","fetch","async","url","res","headers","Accept","ok","Error","text","json","query","endpoint","sparql","encodeURIComponent","graph","config","head","lets","data","results","bindings","key1","key2","label1","label2","value1","value2","check","Map","index","i","length","datum","key1Val","value","key2Val","label1Val","label2Val","value1Val","value2Val","has","nodes","push","set","links","get","tree","opts","root","parent","child","pair","size","children","traverse","node","list","map","d","subtotal","d3","sum","htmltable","columns","selector","limit","undefined","offset","slice","table","select","append","attr","thead","tbody","selectAll","enter","col","cells","row","val","style","htmlhash","barchart","label_x","label_y","let_x","let_y","width","height","margin","scale_x","scale","ordinal","rangeRoundBands","scale_y","linear","range","axis_x","svg","axis","orient","axis_y","domain","extent","parseInt","ax","call","ay","bar","rangeBand","piechart","label","hole","radius","Math","min","max","color","category20","arc","outerRadius","innerRadius","pie","layout","g","centroid","scatterplot","label_r","let_r","min_r","max_r","margin_x","margin_y","extent_x","extent_y","extent_r","scale_r","circle","forcegraph","parseFloat","charge","distance","link","force","linkDistance","start","on","source","x","y","target","drag","sankey","nodeWidth","nodePadding","path","dy","sort","a","b","behavior","origin","parentNode","appendChild","this","event","relayout","dx","filter","roundtree","diameter","angle","depth","tree_layout","separation","diagonal","radial","projection","PI","name","dendrogram","cluster","sunburst","sqrt","startAngle","endAngle","partition","click","transition","duration","attrTween","xd","interpolate","yd","maxDepth","yr","t","arcTween","e","isParentOf","each","apply","p","c","some","circlepack","w","h","r","pack","vis","zoom","k","altKey","stopPropagation","window","treemap","count","category20c","top","right","bottom","left","sticky","treemapzoom","transitioning","format","ratio","round","grandparent","rect","initialize","forEach","display","g1","insert","g2","t1","t2","remove","classed","coordmap","let_lat","let_lng","topojson","geo","equirectangular","translate","precision","graticule","outline","error","world","objects","land","countries","namedmap","color_max","color_min","color_scale","mapname","keyname","center_lat","center_lng","nest","key","rollup","values","topojson_map","geometries","mercator","center","log","properties","lat","latitude","lng","longitude","type","html","toggle","button","elem","frameheight","self","frameElement"],"mappings":"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"}